<!doctype html><html class=no-js lang=en><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><title>泛癌症单细胞分析揭示了肿瘤微环境中肿瘤相关成纤维细胞的异质性和可塑性 - 文字轨迹</title>
<script>(function(e,t){e[t]=e[t].replace("no-js","js")})(document.documentElement,"className")</script><meta name=description content><meta property="og:url" content="https://ixxmu.github.io/posts/others/%E6%B3%9B%E7%99%8C%E7%97%87%E5%8D%95%E7%BB%86%E8%83%9E%E5%88%86%E6%9E%90%E6%8F%AD%E7%A4%BA%E4%BA%86%E8%82%BF%E7%98%A4%E5%BE%AE%E7%8E%AF%E5%A2%83%E4%B8%AD%E8%82%BF%E7%98%A4%E7%9B%B8%E5%85%B3%E6%88%90%E7%BA%A4%E7%BB%B4%E7%BB%86%E8%83%9E%E7%9A%84%E5%BC%82%E8%B4%A8%E6%80%A7%E5%92%8C%E5%8F%AF%E5%A1%91%E6%80%A7/"><meta property="og:site_name" content="文字轨迹"><meta property="og:title" content="泛癌症单细胞分析揭示了肿瘤微环境中肿瘤相关成纤维细胞的异质性和可塑性"><meta property="og:description" content="泛癌症单细胞分析揭示了肿瘤微环境中肿瘤相关成纤维细胞的异质性和可塑性 by 生信菜鸟团 这周推文是对一篇今年刚发的文章所用的数据集进行了复现，GSE210347，由于文章所用数据太大，用个人电脑进行复现请谨慎。"><meta property="og:locale" content="zh_cn"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-11-24T05:01:12+00:00"><meta property="article:modified_time" content="2022-11-24T05:01:12+00:00"><meta property="article:tag" content="Fetched"><meta property="article:tag" content="生信菜鸟团"><meta itemprop=name content="泛癌症单细胞分析揭示了肿瘤微环境中肿瘤相关成纤维细胞的异质性和可塑性"><meta itemprop=description content="泛癌症单细胞分析揭示了肿瘤微环境中肿瘤相关成纤维细胞的异质性和可塑性 by 生信菜鸟团 这周推文是对一篇今年刚发的文章所用的数据集进行了复现，GSE210347，由于文章所用数据太大，用个人电脑进行复现请谨慎。"><meta itemprop=datePublished content="2022-11-24T05:01:12+00:00"><meta itemprop=dateModified content="2022-11-24T05:01:12+00:00"><meta itemprop=wordCount content="554"><meta itemprop=keywords content="Fetched,生信菜鸟团"><meta name=twitter:card content="summary"><meta name=twitter:title content="泛癌症单细胞分析揭示了肿瘤微环境中肿瘤相关成纤维细胞的异质性和可塑性"><meta name=twitter:description content="泛癌症单细胞分析揭示了肿瘤微环境中肿瘤相关成纤维细胞的异质性和可塑性 by 生信菜鸟团 这周推文是对一篇今年刚发的文章所用的数据集进行了复现，GSE210347，由于文章所用数据太大，用个人电脑进行复现请谨慎。"><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=dns-prefetch href=//fonts.googleapis.com><link rel=dns-prefetch href=//fonts.gstatic.com><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700"><link rel=stylesheet href=../../../css/style.css><link rel=stylesheet href=../../../css/custom.css><link rel="shortcut icon" href=../../../favicon.ico></head><body class=body><div class="container container--outer"><header class=header><div class="container header__container"><div class=logo><a class=logo__link href=../../../ title=文字轨迹 rel=home><div class="logo__item logo__text"><div class=logo__title>文字轨迹</div><div class=logo__tagline>故事流淌过的地方</div></div></a></div><nav class=menu><button class=menu__btn aria-haspopup=true aria-expanded=false tabindex=0>
<span class=menu__btn-title tabindex=-1>Menu</span></button><ul class=menu__list><li class=menu__item><a class=menu__link href=../../../posts/><span class=menu__text>文章</span></a></li><li class=menu__item><a class=menu__link href=../../../tags/><span class=menu__text>标签</span></a></li><li class=menu__item><a class=menu__link href=../../../about/><span class=menu__text>关于</span></a></li></ul></nav></div></header><div class="wrapper flex"><div class=primary><main class=main role=main><article class=post><header class=post__header><meta name=referrer content="never"><h1 class=post__title>泛癌症单细胞分析揭示了肿瘤微环境中肿瘤相关成纤维细胞的异质性和可塑性</h1><div class="post__meta meta"><div class="meta__item-datetime meta__item"><svg class="meta__icon icon icon-time" width="16" height="14" viewBox="0 0 30 28"><path d="M15 0a14 14 0 110 28 1 1 0 010-28m0 3a3 3 0 100 22 3 3 0 000-22m1 4h-2v8.4l6.8 4.4L22 18l-6-3.8z"/></svg><time class=meta__text datetime=2022-11-24T05:01:12Z>2022-11-24</time></div><div class="meta__item-categories meta__item"><svg class="meta__icon icon icon-category" width="16" height="16" viewBox="0 0 16 16"><path d="m7 2 1 2h8v11H0V2z"/></svg><span class=meta__text><a class=meta__link href=../../../categories/duty/ rel=category>Duty</a></span></div><div class="meta__item-author meta__item"><svg class="meta__icon icon icon-author" width="16" height="16" viewBox="0 0 16 16"><path d="M8 1c2 0 3.5 2 3.5 4.5S10 9 10 9c3 1 4 2 4 6H2c0-4 1-5 4-6 0 0-1.5-1-1.5-3.5S6 1 8 1"/></svg><span class=meta__text>Bloger</span></div></div></header><div class="post__toc toc"><div class=toc__title>Page content</div><div class=toc__menu><nav id=TableOfContents><ul><li><a href=#泛癌症单细胞分析揭示了肿瘤微环境中肿瘤相关成纤维细胞的异质性和可塑性-by-生信菜鸟团>泛癌症单细胞分析揭示了肿瘤微环境中肿瘤相关成纤维细胞的异质性和可塑性 by 生信菜鸟团</a></li></ul></nav></div></div><div class="content post__content clearfix"><h2 id=泛癌症单细胞分析揭示了肿瘤微环境中肿瘤相关成纤维细胞的异质性和可塑性-by-生信菜鸟团>泛癌症单细胞分析揭示了肿瘤微环境中肿瘤相关成纤维细胞的异质性和可塑性 by 生信菜鸟团</h2><div><section data-tool=mdnice编辑器 data-website=https://www.mdnice.com><blockquote data-tool=mdnice编辑器><p>这周推文是对一篇今年刚发的文章所用的数据集进行了复现，GSE210347，由于文章所用数据太大，用个人电脑进行复现请谨慎。</p></blockquote><p data-tool=mdnice编辑器><strong>文章：</strong>Pan-cancer single-cell analysis reveals the heterogeneity and plasticity of cancer associated fibroblasts in the tumor microenvironment.  https://doi.org/10.1038/s41467-022-34395-2</p><figure data-tool=mdnice编辑器><img data-ratio=0.3866995073891626 data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9IP02mdH9Jvxqp1zMx7ORDQgVQXK2hYraAEnRvhBbLQpn8a382CLfnsqPpnlAh23A4D2iaJnn3ccw/640?wx_fmt=png" data-type=png data-w=1218 src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9IP02mdH9Jvxqp1zMx7ORDQgVQXK2hYraAEnRvhBbLQpn8a382CLfnsqPpnlAh23A4D2iaJnn3ccw/640?wx_fmt=png"></figure><p data-tool=mdnice编辑器><strong>文献简介：</strong>肿瘤相关成纤维细胞(CAFs)是肿瘤微环境(TME)的主要组成部分，影响肿瘤标志物的表达，但目前尚未对其在不同肿瘤类型中的普遍存在特征进行系统研究。在这里，为了分析实体癌的TME情况，对10种实体癌的226个样本进行了泛癌分析，这些数据来自12项研究的164个供体的148个原发肿瘤、53个邻近肿瘤和25个正常样本。以描绘单细胞分辨率下的TME，说明异质性CAFs的共性/可塑性。</p><p data-tool=mdnice编辑器><strong>数据集：</strong> 总共纳入了232个单细胞转录组样本(正常= 31;相邻= 54;Tumor = 148)。其中，31个GSM样本来自GSE134355;11个GSM样本与GSE141445相关;49例样本来自EMBL-EBI的ArrayExpress数据库(www.ebi.ac.uk/arrayexpress)，登录号为E-MTAB-8107;2例GSM样本与GSE157703关联;22个GSM样本来源于GSE131907;7个GSM样本来自GSE138709; 31例样本来自EMBL-EBI的ArrayExpress数据库(www.ebi.ac.uk/arrayexpress)，登录号为E-MTAB-6149和E-MTAB-6653; 32例CRR样本与GSA数据库相关，登录号为CRA001160; 10个GSM样本与GSE154778相关; 7份HRR样本可在GSA-Human中获得，登录码为HRA000212; 10例甲状腺样本来源于GSA-Human数据库，登录号为HRA000686; 从http://dna-discovery.stanford.edu/download/1401/下载20份胃标本。</p><p data-tool=mdnice编辑器>汇总好的数据也上传在GEO数据库中为GSE210347</p><figure data-tool=mdnice编辑器><img data-ratio=0.08508508508508508 data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9IP02mdH9Jvxqp1zMx7ORDt1AyGJkuEwvtMhOFzuwFRNn8WicoMB7FSj7EyDtSvdwj87s5IwY3QoQ/640?wx_fmt=png" data-type=png data-w=999 src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9IP02mdH9Jvxqp1zMx7ORDt1AyGJkuEwvtMhOFzuwFRNn8WicoMB7FSj7EyDtSvdwj87s5IwY3QoQ/640?wx_fmt=png"></figure><p data-tool=mdnice编辑器><strong>文章复现图：</strong></p><figure data-tool=mdnice编辑器><img data-ratio=0.6601423487544484 data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9IP02mdH9Jvxqp1zMx7ORDVD7RT7aph2ELtwwlcKRA5TPzo64GCOFLDC5vynTpddIE5RM5RxOebw/640?wx_fmt=png" data-type=png data-w=562 src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9IP02mdH9Jvxqp1zMx7ORDVD7RT7aph2ELtwwlcKRA5TPzo64GCOFLDC5vynTpddIE5RM5RxOebw/640?wx_fmt=png"></figure><p data-tool=mdnice编辑器><strong>step1:导入数据</strong></p><pre data-tool=mdnice编辑器><span></span><code>rm(list=ls())<br>options(stringsAsFactors = <span>F</span>) <br><span>library</span>(Seurat)<br><span>library</span>(ggplot2)<br><span>library</span>(clustree)<br><span>library</span>(cowplot)<br><span>library</span>(dplyr)<br> <br><span>###### step1:导入数据 ######  </span><br>sce.all=readRDS(<span>"GSE210347_counts.Rds"</span>)<br>sce=CreateSeuratObject(sce.all)<br>table(sce$orig.ident)<br>head(colnames(sce))<br>tail(colnames(sce))<br>sce@assays$RNA@counts[<span>1</span>:<span>10</span>, <span>1</span>:<span>2</span>]<br><br>table(sce$orig.ident)<br>sce$group&lt;-ifelse(grepl(<span>"Colon|um|scrEXT"</span>,colnames(sce)),<span>"colorectal"</span>,<br>    ifelse(grepl(<span>"Bladder1|Bladder2|GallBladder1|GallBladder2"</span>,colnames(sce)),<span>"bladder"</span>,<br>                         ifelse(grepl(<span>"Liver"</span>,colnames(sce)),<span>"liver"</span>,<br>                                ifelse(grepl(<span>"Lung|Sample"</span>,colnames(sce)),<span>"lung"</span>,<br>                                      ifelse(grepl(<span>"Pancreas|PDAC"</span>,colnames(sce)),<span>"PDAC"</span>,<br>                                         ifelse(grepl(<span>"thyroid"</span>,colnames(sce)),<span>"thyroid"</span>,<br>                                 ifelse(grepl(<span>"gastric|Stomach"</span>,colnames(sce)),<span>"gastric"</span>,<br>                                      ifelse(grepl(<span>"prostate"</span>,colnames(sce)),<span>"prostate"</span>,                           ifelse(grepl(<span>"BT"</span>,colnames(sce)),<span>"ovarian"</span>,<span>"breast"</span>)))))))))<br><br>table(sce$group)<br></code></pre><p data-tool=mdnice编辑器><strong>step2: QC 在此省略</strong></p><p data-tool=mdnice编辑器><strong>step3:降维分群</strong></p><pre data-tool=mdnice编辑器><span></span><code><span>#rm(list=ls()) </span><br>dir.create(<span>"2-harmony"</span>)<br>getwd()<br>setwd(<span>"2-harmony"</span>)<br><br>sce=sce.all <br>sce <br>sce &lt;- NormalizeData(sce, <br>                         normalization.method = <span>"LogNormalize"</span>,<br>                         scale.factor = <span>1e4</span>) <br>sce &lt;- FindVariableFeatures(sce)<br>sce &lt;- ScaleData(sce)<br>sce &lt;- RunPCA(sce, features = VariableFeatures(object = sce))<br><br><span>library</span>(harmony)<br>seuratObj &lt;- RunHarmony(sce, <span>"orig.ident"</span>)<br>names(seuratObj@reductions)<br>seuratObj &lt;- RunUMAP(seuratObj,  dims = <span>1</span>:<span>15</span>, <br>                     reduction = <span>"harmony"</span>)<br>DimPlot(seuratObj,reduction = <span>"umap"</span>,label=<span>T</span> ) <br><br>sce=seuratObj<br>sce &lt;- FindNeighbors(sce, reduction = <span>"harmony"</span>,<br>                     dims = <span>1</span>:<span>15</span>) <br>sce.all=sce<br><br><span>#接下来分析，按照分辨率为0.3进行 </span><br>sel.clust = <span>"RNA_snn_res.0.3"</span><br>sce.all &lt;- SetIdent(sce.all, value = sel.clust)<br>table(sce.all@active.ident) <br>saveRDS(sce.all, <span>"sce.all_int.rds"</span>)<br></code></pre><p data-tool=mdnice编辑器><strong>step4:检查常见分群情况</strong></p><pre data-tool=mdnice编辑器><span></span><code><span>###### step5 检查常见分群情况  ######</span><br>dir.create(<span>"../3-cell"</span>)<br>setwd(<span>"../3-cell"</span>)  <br><br>DimPlot(sce.all, reduction = <span>"umap"</span>, group.by = <span>"seurat_clusters"</span>,label = <span>T</span>) <br>DimPlot(sce.all, reduction = <span>"umap"</span>, group.by = <span>"RNA_snn_res.0.3"</span>,label = <span>T</span>) <br>ggsave(<span>'umap_by_RNA_snn_res.0.3.pdf'</span>)<br><br><span>library</span>(ggplot2) <br>genes_to_check = c(<span>'PTPRC'</span>, <span>'CD3D'</span>, <span>'CD3E'</span>, <span>'CD4'</span>,<span>'CD8A'</span>,<br>                   <span>'CD19'</span>, <span>'CD79A'</span>, <span>'MS4A1'</span> ,<br>                   <span>'IGHG1'</span>, <span>'MZB1'</span>, <span>'SDC1'</span>,<br>                   <span>'CD68'</span>, <span>'CD163'</span>, <span>'CD14'</span>, <br>                   <span>'TPSAB1'</span> , <span>'TPSB2'</span>,  <span># mast cells,</span><br>                   <span>'RCVRN'</span>,<span>'FPR1'</span> , <span>'ITGAM'</span> ,<br>                   <span>'C1QA'</span>,  <span>'C1QB'</span>,  <span># mac</span><br>                   <span>'S100A9'</span>, <span>'S100A8'</span>, <span>'MMP19'</span>,<span># monocyte</span><br>                   <span>'FCGR3A'</span>,<br>                   <span>'LAMP3'</span>, <span>'IDO1'</span>,<span>'IDO2'</span>,<span>## DC3 </span><br>                   <span>'CD1E'</span>,<span>'CD1C'</span>, <span># DC2</span><br>                   <span>'KLRB1'</span>,<span>'NCR1'</span>, <span># NK </span><br>                   <span>'FGF7'</span>,<span>'MME'</span>, <span>'ACTA2'</span>, <span>## fibo </span><br>                   <span>'DCN'</span>, <span>'LUM'</span>,  <span>'GSN'</span> , <span>## mouse PDAC fibo </span><br>                   <span>'Amy1'</span> , <span>'Amy2a2'</span>, <span># Acinar_cells</span><br>                   <span>'PECAM1'</span>, <span>'VWF'</span>,  <span>## endo </span><br>                   <span>'EPCAM'</span> , <span>'KRT19'</span>, <span>'PROM1'</span>, <span>'ALDH1A1'</span> )<br><br><span>library</span>(stringr)  <br>genes_to_check=str_to_upper(genes_to_check)<br>genes_to_check<br>p &lt;- DotPlot(sce.all, features = unique(genes_to_check),<br>             assay=<span>'RNA'</span>)  + coord_flip()<br><br>p <br>ggsave(<span>'check_last_markers.pdf'</span>,height = <span>11</span>,width = <span>11</span>)<br><br><br>p_umap=DimPlot(sce.all, reduction = <span>"umap"</span>,<br>               group.by = <span>"RNA_snn_res.0.3"</span>,label = <span>T</span>) <br><span>library</span>(patchwork)<br>p+p_umap<br>ggsave(<span>'markers_umap.pdf'</span>,width = <span>20</span>,height = <span>12</span>)<br>DimPlot(sce.all, reduction = <span>"umap"</span>,split.by = <span>'orig.ident'</span>,<br>        group.by = <span>"RNA_snn_res.0.3"</span>,label = <span>T</span>) <br>ggsave(<span>'orig.ident_umap.pdf'</span>,width = <span>30</span>,height = <span>5</span>)<br>DimPlot(sce.all, reduction = <span>"umap"</span>,split.by = <span>'group'</span>,<br>        group.by = <span>"RNA_snn_res.0.3"</span>,label = <span>T</span>) <br>ggsave(<span>'group_umap.pdf'</span>,width = <span>30</span>,height = <span>5</span>)<br></code></pre><figure data-tool=mdnice编辑器><img data-ratio=0.5995525727069351 data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9IP02mdH9Jvxqp1zMx7ORDTmNseE5DeIMnoRib64W7icsUFS5ufVClob6Aiaa0NPkh1ricmR5aLXcX8A/640?wx_fmt=png" data-type=png data-w=1341 src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9IP02mdH9Jvxqp1zMx7ORDTmNseE5DeIMnoRib64W7icsUFS5ufVClob6Aiaa0NPkh1ricmR5aLXcX8A/640?wx_fmt=png"></figure><p data-tool=mdnice编辑器><strong>step5：细胞亚群生物学命名</strong></p><pre data-tool=mdnice编辑器><span></span><code>table(sce.all@meta.data$RNA_snn_res.0.3)<br>  <span>#细胞分群命名</span><br>  celltype=data.frame(ClusterID=<span>0</span>:<span>29</span>,<br>                      celltype= <span>0</span>:<span>29</span>) <br>  <br>  <span>#定义细胞亚群  </span><br>  celltype[celltype$ClusterID %<span>in</span>% c(<span>0</span>,<span>15</span>,<span>17</span>,<span>19</span>,<span>21</span>,<span>22</span>),<span>2</span>]=<span>'T cells'</span><br>  celltype[celltype$ClusterID %<span>in</span>% c(<span>16</span>,<span>26</span>,<span>9</span>),<span>2</span>]=<span>'B cells'</span><br>  celltype[celltype$ClusterID %<span>in</span>% c(<span>18</span>),<span>2</span>]=<span>'mast'</span><br>  celltype[celltype$ClusterID %<span>in</span>% c(<span>1</span>,<span>23</span>,<span>5</span>,<span>28</span>),<span>2</span>]=<span>'myeloid'</span><br>  <br>  celltype[celltype$ClusterID %<span>in</span>% c(<span>4</span>,<span>6</span>,<span>7</span>,<span>10</span>,<span>11</span>,<span>12</span>,<span>13</span>,<span>24</span>,<span>25</span>,<span>27</span>,<span>14</span>,<span>20</span>),<span>2</span>]=<span>'epi'</span><br>  celltype[celltype$ClusterID %<span>in</span>% c(<span>29</span>,<span>3</span>),<span>2</span>]=<span>'Endo'</span><br>  celltype[celltype$ClusterID %<span>in</span>% c(<span>2</span>,<span>8</span>),<span>2</span>]=<span>'fibo'</span><br><br>  <br>  head(celltype)<br>  celltype<br>  table(celltype$celltype)<br>  sce.all@meta.data$celltype = <span>"NA"</span><br>  <span>for</span>(i <span>in</span> <span>1</span>:nrow(celltype)){<br>    sce.all@meta.data[which(sce.all@meta.data$RNA_snn_res.0.3 == celltype$ClusterID[i]),<span>'celltype'</span>] &lt;- celltype$celltype[i]}<br>  table(sce.all@meta.data$celltype)<br><br> <span>library</span>(ggsci)<br>  color = c(pal_d3(<span>"category20"</span>)(<span>20</span>),<br>            pal_d3(<span>"category20b"</span>)(<span>20</span>),<br>            pal_d3(<span>"category20c"</span>)(<span>20</span>),<br>            pal_d3(<span>"category10"</span>)(<span>10</span>))<br>  <br>  DimPlot(sce.all, reduction = <span>"umap"</span>, group.by = <span>"celltype"</span>,<br>          cols = color,<br>          pt.size = <span>1.5</span>,<br>          label = <span>T</span>,label.box = <span>T</span><br>  ) <br>  ggsave(<span>'celltype-umap_2.pdf'</span>,height = <span>6</span>,width = <span>8</span>) <br><br>  <span>library</span>(stringr)  <br>  genes_to_check=str_to_upper(genes_to_check)<br>  genes_to_check<br>  th=theme(axis.text.x = element_text(angle = <span>45</span>, <br>                                      vjust = <span>0.5</span>, hjust=<span>0.5</span>))  <br>  p &lt;- DotPlot(sce.all, features = unique(genes_to_check) , assay=<span>'RNA'</span> ,group.by =                                     <span>'celltype'</span> )  + coord_flip()  +th<br>  p<br>  ggsave(plot=p, filename=<span>"check_marker_by_all.pdf"</span>,width = <span>10</span> ,height = <span>9</span>)<br></code></pre><figure data-tool=mdnice编辑器><img data-ratio=0.7202028740490279 data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9IP02mdH9Jvxqp1zMx7ORDTGJvXQ9XR0M9FHIlUE9UVibUF0yCJqjtZYWia9wgsIBD6tZFeqIgMcow/640?wx_fmt=png" data-type=png data-w=1183 src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9IP02mdH9Jvxqp1zMx7ORDTGJvXQ9XR0M9FHIlUE9UVibUF0yCJqjtZYWia9wgsIBD6tZFeqIgMcow/640?wx_fmt=png"></figure><p data-tool=mdnice编辑器><strong>step6: 根据10种实体癌症分组看细胞亚群分布</strong></p><pre data-tool=mdnice编辑器><span></span><code><span># 1.加载R包 ----</span><br>rm(list=ls()) <br><span>library</span>(ggplot2) <br><span>library</span>(cowplot) <br><span>library</span>(paletteer)  <br><span>library</span>(gplots)<br><span>library</span>(ggpubr)    <br><span>library</span>(ggsci) <br><span>library</span>(stringr)<br><br><span># 2.设置工作路径 ----</span><br><span>#在meta信息中添加分组信息</span><br>getwd() <br>dir.create(<span>"../4_group"</span>)<br>setwd(<span>"../4_group/"</span>)<br>phe=sce.all@meta.data<br><span># 4.可视化 ----</span><br><span>## 4.1 每种细胞类型中，分组所占比例 ----</span><br><span>library</span>(tidyr)<span># 使用的gather &amp; spread</span><br><span>library</span>(reshape2) <span># 使用的函数 melt &amp; dcast </span><br><span>library</span>(dplyr)<br>tb=table(phe$celltype,<br>         phe$group)<br>head(tb)<br>balloonplot(tb)<br>bar_data &lt;- as.data.frame(tb)<br><br>bar_per &lt;- bar_data %&gt;% <br>  group_by(Var1) %&gt;%<br>  mutate(sum(Freq)) %&gt;%<br>  mutate(percent = Freq / `sum(Freq)`)<br>head(bar_per) <br>write.csv(bar_per,file = <span>"celltype_by_group_percent.csv"</span>)<br><span>library</span>(ggplot2)<br>ggplot(bar_per, aes(x = Var1, y = percent)) +<br>  geom_bar(aes(fill = Var2) , stat = <span>"identity"</span>) + coord_flip() +<br>  theme(axis.ticks = element_line(linetype = <span>"blank"</span>),<br>        legend.position = <span>"top"</span>,<br>        panel.grid.minor = element_line(colour = <span>NA</span>,linetype = <span>"blank"</span>), <br>        panel.background = element_rect(fill = <span>NA</span>),<br>        plot.background = element_rect(colour = <span>NA</span>)) +<br>  labs(y = <span>"% Relative cell source"</span>, fill = <span>NULL</span>)+labs(x = <span>NULL</span>)+<br>  scale_fill_d3()<br><span>#可视化</span><br>ggsave(<span>"celltype_by_group_percent.pdf"</span>,<br>       units = <span>"cm"</span>,width = <span>20</span>,height = <span>12</span>)<br></code></pre><figure data-tool=mdnice编辑器><img data-ratio=0.6063618290258449 data-src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9IP02mdH9Jvxqp1zMx7ORDURtjnvdBZ3AfnjeNic27BYMDk1v2zRr0hQziamDbGLrw88XBnwFtvxicQ/640?wx_fmt=png" data-type=png data-w=1006 src="https://mmbiz.qpic.cn/mmbiz_png/iaRJcrq2Los9IP02mdH9Jvxqp1zMx7ORDURtjnvdBZ3AfnjeNic27BYMDk1v2zRr0hQziamDbGLrw88XBnwFtvxicQ/640?wx_fmt=png"></figure><blockquote data-tool=mdnice编辑器><p>我们可以从细胞分布图中看出与上皮癌细胞的组织类型特异性分布相比，无论恶性状态和组织类型，TME均无明显偏倚。</p><p>除此之外也可从对不同实体肿瘤进行tumor, normal 和 adjacent分组入手进行分析。</p><p>文章中提取成纤维细胞亚群进一步分析，感兴趣的可以去看看。<br></p></blockquote></section><p><br></p><p><mp-style-type data-value=3></mp-style-type></p></div><hr><a href=https://mp.weixin.qq.com/s/zgALlaJv444C1ksZDqJV8w ,target=_blank rel="noopener noreferrer">原文链接</a></div><footer class=post__footer><div class="post__tags tags clearfix"><svg class="tags__badge icon icon-tag" width="16" height="16" viewBox="0 0 32 32"><path d="M4 0h8s2 0 4 2l15 15s2 2 0 4L21 31s-2 2-4 0L2 16s-2-2-2-4V3s0-3 4-3m3 10a3 3 0 000-6 3 3 0 000 6"/></svg><ul class=tags__list><li class=tags__item><a class="tags__link btn" href=../../../tags/fetched/ rel=tag>fetched</a></li><li class=tags__item><a class="tags__link btn" href=../../../tags/%E7%94%9F%E4%BF%A1%E8%8F%9C%E9%B8%9F%E5%9B%A2/ rel=tag>生信菜鸟团</a></li></ul></div></footer></article></main><div class="authorbox clearfix"><div class=authorbox__header><span class=authorbox__name>About Bloger</span></div></div><nav class="pager flex"><div class="pager__item pager__item--prev"><a class=pager__link href=../../../posts/others/clustergvis_%E5%AF%B9%E5%9F%BA%E5%9B%A0%E8%A1%A8%E8%BE%BE%E6%97%B6%E9%97%B4%E5%BA%8F%E5%88%97%E8%81%9A%E7%B1%BB%E5%92%8C%E5%8F%AF%E8%A7%86%E5%8C%96/ rel=prev><span class=pager__subtitle>«&#8201;Previous</span><p class=pager__title>ClusterGVis 对基因表达时间序列聚类和可视化</p></a></div><div class="pager__item pager__item--next"><a class=pager__link href=../../../posts/others/%E5%93%88%E5%96%BD%E5%BE%90%E5%B7%9E_%E6%88%91%E6%98%AF%E9%83%91%E5%B7%9E__/ rel=next><span class=pager__subtitle>Next&#8201;»</span><p class=pager__title>哈喽徐州，我是郑州……</p></a></div></nav><section class=comments><div id=disqus_thread></div><script>window.disqus_config=function(){},function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="//kkitown.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></section></div><aside class=sidebar><div class="widget-search widget"><form class=widget-search__form role=search method=get action=https://google.com/search><input class=widget-search__field type=search placeholder=Search… name=q aria-label=Search…>
<input class=widget-search__submit type=submit value=Search>
<input type=hidden name=sitesearch value=https://ixxmu.github.io/></form></div><div class="widget-recent widget"><h4 class=widget__title>Recent Posts</h4><div class=widget__content><ul class=widget__list><li class=widget__item><a class=widget__link href=../../../posts/2025-03/%E7%BE%8E%E5%9B%BD%E6%BB%A1%E4%B8%96%E7%95%8C%E6%89%BE%E7%9A%84%E7%A8%80%E5%9C%9F%E8%B5%84%E6%BA%90_%E5%88%B0%E5%BA%95%E6%98%AF%E4%B8%AA%E5%95%A5_/>美国满世界找的稀土资源，到底是个啥？</a></li><li class=widget__item><a class=widget__link href=../../../posts/2025-02/_%E8%87%AA%E7%84%B6_%E6%B5%8B%E8%AF%84%E5%A4%A7%E6%A8%A1%E5%9E%8B_%E5%85%A8%E8%83%BD%E5%9E%8Bor%E7%89%9B%E9%A9%AC%E5%9E%8B_%E4%BD%A0%E7%94%A8%E7%9A%84ai%E4%BB%80%E4%B9%88%E5%9E%8B_/>《自然》测评大模型：全能型or牛马型？你用的AI什么型？</a></li><li class=widget__item><a class=widget__link href=../../../posts/2025-02/%E6%88%91_%E4%BA%8C%E6%9C%AC%E5%87%BA%E8%BA%AB_%E6%83%B3%E5%81%9A%E5%AD%A6%E6%9C%AF/>我，二本出身，想做学术</a></li><li class=widget__item><a class=widget__link href=../../../posts/2025-02/%E9%A9%BE%E9%A9%AD_deep_research_%E4%BD%A0%E5%BF%85%E9%A1%BB%E7%9F%A5%E9%81%93%E7%9A%84_100_%E4%BB%B6%E4%BA%8B_%E4%B8%80%E6%AC%A1%E6%80%A7%E6%9E%84%E5%BB%BA%E5%87%BA%E4%BD%A0%E7%9A%84_deep_research_%E4%B8%AA%E4%BA%BA%E7%9F%A5%E8%AF%86%E4%BD%93%E7%B3%BB/>驾驭 deep research，你必须知道的 100 件事｜一次性构建出你的 deep research 个人知识体系</a></li><li class=widget__item><a class=widget__link href=../../../posts/2025-02/%E9%9B%B6%E5%9F%BA%E7%A1%80%E5%85%A5%E9%97%A8_deepseek%E5%BE%AE%E8%B0%83%E7%9A%84%E8%AF%84%E6%B5%8B%E6%95%99%E7%A8%8B%E6%9D%A5%E4%BA%86_/>零基础入门：DeepSeek微调的评测教程来了！</a></li></ul></div></div><div class="widget-categories widget"><h4 class=widget__title>Categories</h4><div class=widget__content><ul class=widget__list><li class=widget__item><a class=widget__link href=../../../categories/duty/>Duty</a></li><li class=widget__item><a class=widget__link href=../../../categories/duty2/>Duty2</a></li></ul></div></div><div class="widget-taglist widget"><h4 class=widget__title>Tags</h4><div class=widget__content><a class="widget-taglist__link widget__link btn" href=../../../tags/cnbeta/ title=Cnbeta>Cnbeta (92)</a>
<a class="widget-taglist__link widget__link btn" href=../../../tags/datawhale/ title=Datawhale>Datawhale (6)</a>
<a class="widget-taglist__link widget__link btn" href=../../../tags/fetched/ title=Fetched>Fetched (627)</a>
<a class="widget-taglist__link widget__link btn" href=../../../tags/githubdaily/ title=GitHubDaily>GitHubDaily (7)</a>
<a class="widget-taglist__link widget__link btn" href=../../../tags/%E4%B8%81%E9%A6%99%E5%9B%AD/ title=丁香园>丁香园 (28)</a>
<a class="widget-taglist__link widget__link btn" href=../../../tags/%E4%BA%BA%E7%89%A9/ title=人物>人物 (15)</a>
<a class="widget-taglist__link widget__link btn" href=../../../tags/%E5%8D%97%E6%96%B9%E5%91%A8%E6%9C%AB/ title=南方周末>南方周末 (11)</a>
<a class="widget-taglist__link widget__link btn" href=../../../tags/%E5%B0%8F%E4%BC%97%E8%BD%AF%E4%BB%B6/ title=小众软件>小众软件 (5)</a>
<a class="widget-taglist__link widget__link btn" href=../../../tags/%E5%B0%8F%E5%A4%A7%E5%A4%AB%E6%BC%AB%E7%94%BB/ title=小大夫漫画>小大夫漫画 (5)</a>
<a class="widget-taglist__link widget__link btn" href=../../../tags/%E5%B0%91%E6%95%B0%E6%B4%BE/ title=少数派>少数派 (6)</a>
<a class="widget-taglist__link widget__link btn" href=../../../tags/%E5%BE%AA%E5%9B%A0%E7%BC%89%E8%8D%AF/ title=循因缉药>循因缉药 (7)</a>
<a class="widget-taglist__link widget__link btn" href=../../../tags/%E6%98%9F%E7%90%83%E5%95%86%E4%B8%9A%E8%AF%84%E8%AE%BA/ title=星球商业评论>星球商业评论 (6)</a>
<a class="widget-taglist__link widget__link btn" href=../../../tags/%E6%9C%AA%E9%97%BBcode/ title=未闻Code>未闻Code (5)</a>
<a class="widget-taglist__link widget__link btn" href=../../../tags/%E6%A7%BD%E8%BE%B9%E5%BE%80%E4%BA%8B/ title=槽边往事>槽边往事 (7)</a>
<a class="widget-taglist__link widget__link btn" href=../../../tags/%E6%AF%8F%E6%97%A5%E4%BA%BA%E7%89%A9/ title=每日人物>每日人物 (6)</a>
<a class="widget-taglist__link widget__link btn" href=../../../tags/%E6%B5%AE%E4%B9%8B%E9%9D%99/ title=浮之静>浮之静 (6)</a>
<a class="widget-taglist__link widget__link btn" href=../../../tags/%E7%81%BC%E8%A7%81/ title=灼见>灼见 (6)</a>
<a class="widget-taglist__link widget__link btn" href=../../../tags/%E7%94%9F%E4%BF%A1%E6%8A%80%E8%83%BD%E6%A0%91/ title=生信技能树>生信技能树 (9)</a>
<a class="widget-taglist__link widget__link btn" href=../../../tags/%E7%9F%A5%E8%AF%86%E5%88%86%E5%AD%90/ title=知识分子>知识分子 (13)</a>
<a class="widget-taglist__link widget__link btn" href=../../../tags/%E7%BD%91%E6%98%93%E6%95%B0%E8%AF%BB/ title=网易数读>网易数读 (5)</a>
<a class="widget-taglist__link widget__link btn" href=../../../tags/%E8%B4%A2%E7%BB%8F%E4%B8%89%E5%88%86%E9%92%9F/ title=财经三分钟>财经三分钟 (7)</a>
<a class="widget-taglist__link widget__link btn" href=../../../tags/%E8%B5%9B%E5%85%88%E7%94%9F/ title=赛先生>赛先生 (5)</a>
<a class="widget-taglist__link widget__link btn" href=../../../tags/%E9%83%91%E5%B7%9E%E6%A5%BC%E5%B8%82/ title=郑州楼市>郑州楼市 (32)</a></div><a href=../../../tags/></a></div><div class="widget-social widget"><h4 class="widget-social__title widget__title">Social</h4><div class="widget-social__content widget__content"><div class="widget-social__item widget__item"><a class="widget-social__link widget__link btn" title=Facebook rel="noopener noreferrer" href=https://facebook.com/username target=_blank><svg class="widget-social__link-icon icon icon-facebook" width="24" height="24" viewBox="0 0 352 352"><path d="m0 32v288c0 17.5 14.5 32 32 32h288c17.5.0 32-14.5 32-32V32c0-17.5-14.5-32-32-32H32C14.5.0.0 14.5.0 32zm320 0v288h-83V212h41.5l6-48H237v-31c0-14 3.5-23.5 23.5-23.5h26V66c-4.4-.6-19.8-1.5-37.5-1.5-36.9.0-62 22.2-62 63.5v36h-42v48h42v108H32V32z"/></svg>
<span>Facebook</span></a></div><div class="widget-social__item widget__item"><a class="widget-social__link widget__link btn" title=Twitter rel="noopener noreferrer" href=https://twitter.com/username target=_blank><svg class="widget-social__link-icon icon icon-twitter" width="24" height="24" viewBox="0 0 384 312"><path d="m384 36.9c-14.1 6.3-29.3 10.5-45.2 12.4 16.3-9.7 28.8-25.2 34.6-43.6-15.2 9-32.1 15.6-50 19.1-14.4-15.2-34.9-24.8-57.5-24.8-43.5.0-78.8 35.3-78.8 78.8.0 6.2.7 12.2 2 17.9-65.5-3.3-123.5-34.6-162.4-82.3C20 26 16.1 39.6 16.1 54c0 27.3 13.9 51.4 35 65.6-12.9-.4-25.1-4-35.7-9.9v1c0 38.2 27.2 70 63.2 77.2-6.6 1.8-13.6 2.8-20.8 2.8-5.1.0-10-.5-14.8-1.4 10 31.3 39.1 54.1 73.6 54.7-27 21.1-60.9 33.7-97.8 33.7-6.4.0-12.6-.4-18.8-1.1C34.9 299 76.3 312 120.8 312c144.9.0 224.1-120 224.1-224.1.0-3.4-.1-6.8-.2-10.2 15.4-11.1 28.7-25 39.3-40.8z"/></svg>
<span>Twitter</span></a></div><div class="widget-social__item widget__item"><a class="widget-social__link widget__link btn" title=Instagram rel="noopener noreferrer" href=https://www.instagram.com/username target=_blank><svg class="widget-social__link-icon icon icon-instagram" width="24" height="24" viewBox="0 0 256 256"><circle cx="193" cy="59" r="15"/><path fill-rule="evenodd" d="M101 0h54c41 0 58.4 3.9 74.5 17C256.2 37.5 256 74.8 256 97.7v60c0 26.7.0 60.4-26.5 81.4-16 13.4-33.5 16.9-74.5 16.9h-54c-41 0-57.5-3.5-74.5-16.9C1 218.9.5 186.3.1 160.5L0 155V97.7c0-23-.2-60.2 26.5-80.7C45 2 60 0 101 0zm4.9 23h44.3c45.8.0 58.3 3.5 70.3 17.5 11.8 13.2 12 30.1 12.5 62.9V156c.2 20.8.3 45.8-12.5 59.5-12 14-24.5 17.5-70.3 17.5h-44.3c-45.9.0-57.3-3.5-70.4-17.5-12.2-13-12.3-36.5-12.4-56.7v-55.6c.4-32.6.7-49.6 12.4-62.7C48 26.5 60 23 105.9 23zm19.6 144.5a42 42 0 100-84 42 42 0 000 84zm0 22.5a64.5 64.5.0 100-129 64.5 64.5.0 000 129z"/></svg>
<span>Instagram</span></a></div></div></div></aside></div><footer class=footer><div class="container footer__container flex"><div class=footer__copyright>&copy; 2025 文字轨迹.
<span class=footer__copyright-credits>Generated with <a href=https://gohugo.io/ rel="nofollow noopener" target=_blank>Hugo</a> and <a href=https://github.com/Vimux/Mainroad/ rel="nofollow noopener" target=_blank>Mainroad</a> theme.</span></div></div></footer></div><script async defer src=../../../js/menu.js></script><script src=../../../js/custom.js></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.6/MathJax.js?config=TeX-AMS-MML_HTMLorMML" async></script></body></html>