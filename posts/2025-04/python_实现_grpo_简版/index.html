<!doctype html><html class=no-js lang=en><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><title>Python å®ç° GRPO ç®€ç‰ˆ - æ–‡å­—è½¨è¿¹</title>
<script>(function(e,t){e[t]=e[t].replace("no-js","js")})(document.documentElement,"className")</script><meta name=description content><meta property="og:url" content="https://ixxmu.github.io/posts/2025-04/python_%E5%AE%9E%E7%8E%B0_grpo_%E7%AE%80%E7%89%88/"><meta property="og:site_name" content="æ–‡å­—è½¨è¿¹"><meta property="og:title" content="Python å®ç° GRPO ç®€ç‰ˆ"><meta property="og:description" content="Python å®ç° GRPO ç®€ç‰ˆ by æ•°æ®STUDIO ä»Šå¤©æˆ‘ä»¬å°†æ·±å…¥æ¢è®¨GRPOçš„å®ç°ã€‚å…ˆç®€è¦ä»‹ç»è¿™ä¸€æ¦‚å¿µï¼Œè®¨è®ºæ–¹æ³•ï¼Œç„¶åå¼€å§‹å…·ä½“å®ç°ã€‚"><meta property="og:locale" content="zh_cn"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-04-18T02:34:42+00:00"><meta property="article:modified_time" content="2025-04-18T02:34:42+00:00"><meta property="article:tag" content="Fetched"><meta property="article:tag" content="æ•°æ®STUDIO"><meta itemprop=name content="Python å®ç° GRPO ç®€ç‰ˆ"><meta itemprop=description content="Python å®ç° GRPO ç®€ç‰ˆ by æ•°æ®STUDIO ä»Šå¤©æˆ‘ä»¬å°†æ·±å…¥æ¢è®¨GRPOçš„å®ç°ã€‚å…ˆç®€è¦ä»‹ç»è¿™ä¸€æ¦‚å¿µï¼Œè®¨è®ºæ–¹æ³•ï¼Œç„¶åå¼€å§‹å…·ä½“å®ç°ã€‚"><meta itemprop=datePublished content="2025-04-18T02:34:42+00:00"><meta itemprop=dateModified content="2025-04-18T02:34:42+00:00"><meta itemprop=wordCount content="614"><meta itemprop=keywords content="Fetched,æ•°æ®STUDIO"><meta name=twitter:card content="summary"><meta name=twitter:title content="Python å®ç° GRPO ç®€ç‰ˆ"><meta name=twitter:description content="Python å®ç° GRPO ç®€ç‰ˆ by æ•°æ®STUDIO ä»Šå¤©æˆ‘ä»¬å°†æ·±å…¥æ¢è®¨GRPOçš„å®ç°ã€‚å…ˆç®€è¦ä»‹ç»è¿™ä¸€æ¦‚å¿µï¼Œè®¨è®ºæ–¹æ³•ï¼Œç„¶åå¼€å§‹å…·ä½“å®ç°ã€‚"><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=dns-prefetch href=//fonts.googleapis.com><link rel=dns-prefetch href=//fonts.gstatic.com><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700"><link rel=stylesheet href=../../../css/style.css><link rel=stylesheet href=../../../css/custom.css><link rel="shortcut icon" href=../../../favicon.ico></head><body class=body><div class="container container--outer"><header class=header><div class="container header__container"><div class=logo><a class=logo__link href=../../../ title=æ–‡å­—è½¨è¿¹ rel=home><div class="logo__item logo__text"><div class=logo__title>æ–‡å­—è½¨è¿¹</div><div class=logo__tagline>æ•…äº‹æµæ·Œè¿‡çš„åœ°æ–¹</div></div></a></div><nav class=menu><button class=menu__btn aria-haspopup=true aria-expanded=false tabindex=0>
<span class=menu__btn-title tabindex=-1>Menu</span></button><ul class=menu__list><li class=menu__item><a class=menu__link href=../../../posts/><span class=menu__text>æ–‡ç« </span></a></li><li class=menu__item><a class=menu__link href=../../../tags/><span class=menu__text>æ ‡ç­¾</span></a></li><li class=menu__item><a class=menu__link href=../../../about/><span class=menu__text>å…³äº</span></a></li></ul></nav></div></header><div class="wrapper flex"><div class=primary><main class=main role=main><article class=post><header class=post__header><meta name=referrer content="never"><h1 class=post__title>Python å®ç° GRPO ç®€ç‰ˆ</h1><div class="post__meta meta"><div class="meta__item-datetime meta__item"><svg class="meta__icon icon icon-time" width="16" height="14" viewBox="0 0 30 28"><path d="M15 0a14 14 0 110 28 1 1 0 010-28m0 3a3 3 0 100 22 3 3 0 000-22m1 4h-2v8.4l6.8 4.4L22 18l-6-3.8z"/></svg><time class=meta__text datetime=2025-04-18T02:34:42Z>2025-04-18</time></div><div class="meta__item-categories meta__item"><svg class="meta__icon icon icon-category" width="16" height="16" viewBox="0 0 16 16"><path d="m7 2 1 2h8v11H0V2z"/></svg><span class=meta__text><a class=meta__link href=../../../categories/duty/ rel=category>Duty</a></span></div><div class="meta__item-author meta__item"><svg class="meta__icon icon icon-author" width="16" height="16" viewBox="0 0 16 16"><path d="M8 1c2 0 3.5 2 3.5 4.5S10 9 10 9c3 1 4 2 4 6H2c0-4 1-5 4-6 0 0-1.5-1-1.5-3.5S6 1 8 1"/></svg><span class=meta__text>Bloger</span></div></div></header><div class="post__toc toc"><div class=toc__title>Page content</div><div class=toc__menu><nav id=TableOfContents><ul><li><a href=#python-å®ç°-grpo-ç®€ç‰ˆ-by-æ•°æ®studio>Python å®ç° GRPO ç®€ç‰ˆ by æ•°æ®STUDIO</a></li></ul></nav></div></div><div class="content post__content clearfix"><h2 id=python-å®ç°-grpo-ç®€ç‰ˆ-by-æ•°æ®studio>Python å®ç° GRPO ç®€ç‰ˆ by æ•°æ®STUDIO</h2><div><p data-mpa-powered-by=yiban.io><span leaf><img data-ratio=0.1782178217821782 data-type=gif data-w=606 data-src="https://mmbiz.qpic.cn/mmbiz_gif/gX9JE5tiaI7ibSBAB7MzqzBARx8T3TBZruGNeET47qhWwjg4BqHeZ1x5mGWvyVXy4pJclLnUblwlbcScjxFGNP5A/640?wx_fmt=gif" src="https://mmbiz.qpic.cn/mmbiz_gif/gX9JE5tiaI7ibSBAB7MzqzBARx8T3TBZruGNeET47qhWwjg4BqHeZ1x5mGWvyVXy4pJclLnUblwlbcScjxFGNP5A/640?wx_fmt=gif"></span><span leaf><br></span></p><section data-tool=mdniceç¼–è¾‘å™¨ data-website=https://www.mdnice.com><section nodeleaf><img data-ratio=0.15255813953488373 data-type=gif data-w=1075 data-src="https://mmbiz.qpic.cn/mmbiz_gif/gX9JE5tiaI7ibWWVA1RARlHw5jnibnfd6JGic5gARmlWo6uUAWD1ibWdqOWynFaJMcVWXw42637bhaKOybTxQgib4DEQ/640?wx_fmt=gif" src="https://mmbiz.qpic.cn/mmbiz_gif/gX9JE5tiaI7ibWWVA1RARlHw5jnibnfd6JGic5gARmlWo6uUAWD1ibWdqOWynFaJMcVWXw42637bhaKOybTxQgib4DEQ/640?wx_fmt=gif"></section><p data-tool=mdniceç¼–è¾‘å™¨><span leaf>ä»Šå¤©æˆ‘ä»¬å°†æ·±å…¥æ¢è®¨GRPOçš„å®ç°ã€‚å…ˆç®€è¦ä»‹ç»è¿™ä¸€æ¦‚å¿µï¼Œè®¨è®ºæ–¹æ³•ï¼Œç„¶åå¼€å§‹å…·ä½“å®ç°ã€‚</span></p><p data-tool=mdniceç¼–è¾‘å™¨><span leaf><img data-imgfileid=100106564 data-type=png data-ratio=0.5981481481481481 data-w=1080 data-src="https://mmbiz.qpic.cn/mmbiz_png/gX9JE5tiaI7icmiaFXCvSicjxy977LFVaPO6FFDjMrfRP0K4qyQ5rO0uhMqEjE3TwYFbtUnKjeQreiaExmVGUCt7gicA/640?wx_fmt=png&amp;from=appmsg" src="https://mmbiz.qpic.cn/mmbiz_png/gX9JE5tiaI7icmiaFXCvSicjxy977LFVaPO6FFDjMrfRP0K4qyQ5rO0uhMqEjE3TwYFbtUnKjeQreiaExmVGUCt7gicA/640?wx_fmt=png&amp;from=appmsg"></span></p><h2 data-tool=mdniceç¼–è¾‘å™¨><span data-cacheurl data-remoteid></span><span></span><span><span leaf>ä»€ä¹ˆæ˜¯GRPOï¼Ÿ</span></span><span></span></h2><p data-tool=mdniceç¼–è¾‘å™¨><span leaf>GRPOæ˜¯ä¸€ç§è®­ç»ƒæŠ€æœ¯ï¼Œæ—¨åœ¨é€šè¿‡æ•æ‰ç‰¹å®šåå¥½çš„å¥–åŠ±å‡½æ•°æ¥ä¼˜åŒ–è¯­è¨€æ¨¡å‹ã€‚ä¸å…¶ä»–å¼ºåŒ–å­¦ä¹ æ–¹æ³•ï¼ˆå¦‚PPOæˆ–RLHFï¼‰ä¸åŒï¼ŒGRPOä¸éœ€è¦å¤æ‚çš„è¯„åˆ¤æ¨¡å‹å’Œå¤§é‡è®¡ç®—èµ„æºï¼Œè€Œæ˜¯ç›´æ¥ä¼˜åŒ–è¯­è¨€æ¨¡å‹ï¼Œå¹¶é€šè¿‡åœ¨ç”Ÿæˆçš„å“åº”ç»„å†…è®¡ç®—ç›¸å¯¹ä¼˜åŠ¿æ¥å®ç°ç›®æ ‡ã€‚</span></p><h2 data-tool=mdniceç¼–è¾‘å™¨><span data-cacheurl data-remoteid></span><span></span><span><span leaf>GRPOçš„å…³é”®ç‰¹ç‚¹</span></span><span></span></h2><h3 data-tool=mdniceç¼–è¾‘å™¨><span></span><span><span leaf>GRPOçš„ç‹¬ç‰¹ä¹‹å¤„</span></span><span></span></h3><p data-tool=mdniceç¼–è¾‘å™¨><span leaf>GRPOæ˜¯ä¸€ç§æ–°å…´çš„å¼ºåŒ–å­¦ä¹ æŠ€æœ¯ï¼Œç›¸æ¯”ä¼ ç»Ÿæ–¹æ³•å…·æœ‰ä»¥ä¸‹ä¼˜åŠ¿ï¼š</span></p><ul><li><section><strong><span leaf>ç›´æ¥ä¼˜åŒ–</span></strong><span leaf>ï¼šä¸åŒäºéœ€è¦ç‹¬ç«‹å¥–åŠ±æ¨¡å‹çš„æ–¹æ³•ï¼ŒGRPOç›´æ¥ä½¿ç”¨æ˜¾å¼å¥–åŠ±å‡½æ•°ä¼˜åŒ–è¯­è¨€æ¨¡å‹ã€‚</span></section></li><li><section><strong><span leaf>å¤šå¥–åŠ±ä¿¡å·</span></strong><span leaf>ï¼šå¯ä»¥å®šä¹‰å¤šä¸ªå¥–åŠ±å‡½æ•°ï¼Œé’ˆå¯¹ç”Ÿæˆå†…å®¹çš„ä¸åŒæ–¹é¢ï¼ˆå¦‚æ­£ç¡®æ€§ã€æ ¼å¼ã€é£æ ¼ï¼‰ã€‚</span></section></li><li><section><strong><span leaf>æ¢ç´¢æ•ˆç‡</span></strong><span leaf>ï¼šGRPOé€šè¿‡åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ä¸ºæ¯ä¸ªæç¤ºç”Ÿæˆå¤šä¸ªè¡¥å…¨å†…å®¹ï¼Œæœ‰æ•ˆæ¢ç´¢è¾“å‡ºç©ºé—´ã€‚</span></section></li></ul><h3 data-tool=mdniceç¼–è¾‘å™¨><span></span><span><span leaf>å¥–åŠ±å‡½æ•°</span></span><span></span></h3><p data-tool=mdniceç¼–è¾‘å™¨><span leaf>ä»£ç å®ç°äº†å¤šä¸ªååŒå·¥ä½œçš„å¥–åŠ±å‡½æ•°ï¼Œç”¨äºæŒ‡å¯¼æ¨¡å‹ï¼š</span></p><ul><li><section><strong><span leaf>correctness_reward_func</span></strong><span leaf>ï¼šå½“æ¨¡å‹æå–çš„ç­”æ¡ˆä¸çœŸå®ç­”æ¡ˆåŒ¹é…æ—¶ï¼Œå¥–åŠ±2.0åˆ†ã€‚è¿™æ˜¯äº‹å®æ­£ç¡®æ€§çš„ä¸»è¦å­¦ä¹ ä¿¡å·ã€‚</span></section></li><li><section><strong><span leaf>int_reward_func</span></strong><span leaf>ï¼šå½“ç­”æ¡ˆæ˜¯æ•°å­—æ—¶å¥–åŠ±0.5åˆ†ï¼Œé€‚ç”¨äºæ•°å­¦é—®é¢˜ï¼Œå¼•å¯¼æ¨¡å‹ç”Ÿæˆæ•°å€¼å“åº”ã€‚</span></section></li><li><section><strong><span leaf>soft_format_reward_funcå’Œstrict_format_reward_func</span></strong><span leaf>ï¼šå¥–åŠ±æ­£ç¡®çš„XMLæ ¼å¼ï¼ˆ0.5åˆ†ï¼‰ï¼Œæ•™å¯¼æ¨¡å‹ä½¿ç”¨æ­£ç¡®çš„æ ‡ç­¾ç»“æ„å“åº”ã€‚</span></section></li><li><section><strong><span leaf>xmlcount_reward_func</span></strong><span leaf>ï¼šä¸ºæ¯ä¸ªæ­£ç¡®ä½¿ç”¨çš„XMLæ ‡ç­¾æä¾›éƒ¨åˆ†å¥–åŠ±ï¼ˆæ¯ä¸ªæ ‡ç­¾0.125åˆ†ï¼‰ï¼Œå½¢æˆå¹³æ»‘çš„å­¦ä¹ æ¢¯åº¦ã€‚</span></section></li></ul><h3 data-tool=mdniceç¼–è¾‘å™¨><span></span><span><span leaf>å®ç°ç»„ä»¶</span></span><span></span></h3><ul><li><section><strong><span leaf>å¥–åŠ±å‡½æ•°</span></strong><span leaf>ï¼šæ ¹æ®ç‰¹å®šæ ‡å‡†è¯„ä¼°æ¨¡å‹è¾“å‡ºï¼š</span></section></li><ul><li><section><span leaf>æ­£ç¡®æ€§ï¼šæ£€æŸ¥æå–çš„ç­”æ¡ˆæ˜¯å¦ä¸çœŸå®ç­”æ¡ˆåŒ¹é…ã€‚</span></section></li><li><section><span leaf>æ ¼å¼éµå¾ªï¼šç¡®ä¿å“åº”ç¬¦åˆè¯·æ±‚çš„XMLæ ¼å¼ã€‚</span></section></li><li><section><span leaf>æ•´æ•°æ£€æµ‹ï¼šå¥–åŠ±æ•°å€¼ç­”æ¡ˆã€‚</span></section></li></ul><li><section><strong><span leaf>æ•°æ®é›†å‡†å¤‡</span></strong><span leaf>ï¼šä½¿ç”¨GSM8Kï¼ˆæ•°å­¦åº”ç”¨é¢˜ï¼‰æ•°æ®é›†ï¼Œå¹¶è¿›è¡Œç‰¹å®šæ ¼å¼åŒ–ã€‚</span></section></li><li><section><strong><span leaf>è®­ç»ƒé…ç½®</span></strong><span leaf>ï¼šä½¿ç”¨LoRAè¿›è¡Œå‚æ•°é«˜æ•ˆå¾®è°ƒã€‚</span></section></li></ul><h3 data-tool=mdniceç¼–è¾‘å™¨><span></span><span><span leaf>è®­ç»ƒè¿‡ç¨‹</span></span><span></span></h3><ul><li><section><span leaf>å¯¹äºæ•°æ®é›†ä¸­çš„æ¯ä¸ªæç¤ºï¼Œæ¨¡å‹ç”Ÿæˆå¤šä¸ªè¡¥å…¨å†…å®¹ï¼ˆç”±</span><strong><span leaf>num_generations</span></strong><span leaf>è®¾ç½®ï¼Œä»£ç ä¸­ä¸º4ï¼‰ã€‚</span></section></li><li><section><span leaf>æ¯ä¸ªè¡¥å…¨å†…å®¹ç”±æ‰€æœ‰å¥–åŠ±å‡½æ•°è¯„ä¼°ã€‚</span></section></li><li><section><span leaf>å¥–åŠ±ç”¨äºæ›´æ–°æ¨¡å‹æƒé‡ï¼Œé¼“åŠ±æ¨¡å‹ç”Ÿæˆæ›´é«˜å¥–åŠ±çš„è¾“å‡ºã€‚</span></section></li><li><section><span leaf>æ­¤è¿‡ç¨‹æŒç»­æŒ‡å®šçš„å‘¨æœŸæ•°ã€‚</span></section></li></ul><h3 data-tool=mdniceç¼–è¾‘å™¨><span></span><span><span leaf>å‚æ•°é«˜æ•ˆå¾®è°ƒ</span></span><span></span></h3><p data-tool=mdniceç¼–è¾‘å™¨><span leaf>æˆ‘ä»¬ä½¿ç”¨LoRAï¼ˆä½ç§©é€‚åº”ï¼‰é«˜æ•ˆå¾®è°ƒæ¨¡å‹ã€‚LoRAå‘æ³¨æ„åŠ›å±‚æ·»åŠ å°å‹å¯è®­ç»ƒçš„â€œé€‚é…å™¨â€çŸ©é˜µï¼Œå¤§å¹…å‡å°‘è®­ç»ƒå‚æ•°æ•°é‡ï¼ˆé€šå¸¸>99%ï¼‰ã€‚</span><strong><span leaf>peft_config</span></strong><span leaf>å®šä¹‰äº†ç›®æ ‡å±‚å’Œé€‚é…å™¨çš„ç§©ã€‚</span></p><h3 data-tool=mdniceç¼–è¾‘å™¨><span></span><span><span leaf>å®æ–½è€ƒè™‘</span></span><span></span></h3><ul><li><section><span leaf>ä½¿ç”¨è¾ƒå°çš„æ¨¡å‹ï¼ˆQwen2.5-1.5B-Instructï¼‰ä»¥é€‚åº”å†…å­˜é™åˆ¶ã€‚</span></section></li><li><section><span leaf>å‡å°æ‰¹æ¬¡å¤§å°å’Œç”Ÿæˆæ•°é‡ä»¥ç®¡ç†å†…å­˜ä½¿ç”¨ï¼Œå¹¶ä½¿ç”¨è¾ƒå°çš„æ•°æ®é›†å­é›†ï¼ˆ20ä¸ªç¤ºä¾‹ï¼‰è¿›è¡Œå¿«é€Ÿå®éªŒã€‚</span></section></li><li><section><span leaf>æµ‹è¯•ä»£ç å¯åœ¨è®­ç»ƒåç«‹å³è¯„ä¼°ç»“æœã€‚å¯é€šè¿‡å¢åŠ </span><strong><span leaf>max_samples</span></strong><span leaf>è¡Œæ›´å…¨é¢çš„è®­ç»ƒï¼Œæˆ–å°è¯•ä¸åŒçš„å¥–åŠ±å‡½æ•°ã€‚</span></section></li></ul><h2 data-tool=mdniceç¼–è¾‘å™¨><span data-cacheurl data-remoteid></span><span></span><span><span leaf>ä»£ç å®ç°</span></span><span></span></h2><h3 data-tool=mdniceç¼–è¾‘å™¨><span></span><span><span leaf>å®‰è£…æ‰€éœ€åŒ…</span></span><span></span></h3><pre data-tool=mdniceç¼–è¾‘å™¨><span data-cacheurl data-remoteid></span><code><span leaf>pip install -q transformers datasets trl peft accelerate</span><span leaf><br></span><span leaf>import re</span><span leaf><br></span><span leaf>import torch</span><span leaf><br></span><span leaf>import numpy as np</span><span leaf><br></span><span leaf>from datasets import load_dataset, Dataset</span><span leaf><br></span><span leaf>from transformers import AutoTokenizer, AutoModelForCausalLM</span><span leaf><br></span><span leaf>from peft import LoraConfig, get_peft_model</span><span leaf><br></span><span leaf>from trl import GRPOConfig, GRPOTrainer</span><span leaf><br></span></code></pre><h3 data-tool=mdniceç¼–è¾‘å™¨><span></span><span><span leaf>å®šä¹‰ç³»ç»Ÿå’Œå“åº”æç¤º</span></span><span></span></h3><pre data-tool=mdniceç¼–è¾‘å™¨><span data-cacheurl data-remoteid></span><code><span leaf>SYSTEM_PROMPT =Â </span><span><span leaf>""</span></span><span><span leaf>" Â </span><span leaf><br></span><span leaf>è¯·æŒ‰ä»¥ä¸‹æ ¼å¼å“åº”ï¼š Â </span><span leaf><br></span><span leaf>&lt;reasoning&gt; Â </span><span leaf><br></span><span leaf>... Â </span><span leaf><br></span><span leaf>&lt;/reasoning&gt; Â </span><span leaf><br></span><span leaf>&lt;answer&gt; Â </span><span leaf><br></span><span leaf>... Â </span><span leaf><br></span><span leaf>&lt;/answer&gt; Â </span><span leaf><br></span><span leaf>"</span></span><span><span leaf>""</span></span><span leaf><br></span><span leaf><br></span><span leaf>XML_COT_FORMAT =Â </span><span><span leaf>""</span></span><span><span leaf>" Â </span><span leaf><br></span><span leaf>&lt;reasoning&gt; Â </span><span leaf><br></span><span leaf>{reasoning} Â </span><span leaf><br></span><span leaf>&lt;/reasoning&gt; Â </span><span leaf><br></span><span leaf>&lt;answer&gt; Â </span><span leaf><br></span><span leaf>{answer} Â </span><span leaf><br></span><span leaf>&lt;/answer&gt; Â </span><span leaf><br></span><span leaf>"</span></span><span><span leaf>""</span></span><span leaf><br></span></code></pre><h3 data-tool=mdniceç¼–è¾‘å™¨><span></span><span><span leaf>æå–ç­”æ¡ˆçš„è¾…åŠ©å‡½æ•°</span></span><span></span></h3><pre data-tool=mdniceç¼–è¾‘å™¨><span data-cacheurl data-remoteid></span><code><span leaf>def extract_xml_answer(text: str) -&gt; str: Â </span><span leaf><br></span><span leaf>Â  Â Â </span><span><span leaf>""</span></span><span><span leaf>"ä»XMLæ ¼å¼çš„å“åº”ä¸­æå–ç­”æ¡ˆéƒ¨åˆ†ã€‚"</span></span><span><span leaf>""</span></span><span leaf><br></span><span leaf>Â  Â Â </span><span><span leaf>if</span></span><span><span leaf>"&lt;answer&gt;"</span></span><span leaf>Â notÂ </span><span><span leaf>in</span></span><span leaf>Â text orÂ </span><span><span leaf>"&lt;/answer&gt;"</span></span><span leaf>Â notÂ </span><span><span leaf>in</span></span><span leaf>Â text: Â </span><span leaf><br></span><span leaf>Â  Â  Â  Â Â </span><span><span leaf>return</span></span><span><span leaf>""</span></span><span leaf><br></span><span leaf>Â  Â  answer = text.split(</span><span><span leaf>"&lt;/answer&gt;"</span></span><span leaf>)[-1] Â </span><span leaf><br></span><span leaf>Â  Â  answer = answer.split(</span><span><span leaf>"&lt;answer&gt;"</span></span><span leaf>)[0] Â </span><span leaf><br></span><span leaf>Â  Â Â </span><span><span leaf>return</span></span><span leaf>Â answer.strip() Â </span><span leaf><br></span><span leaf><br></span><span leaf>def extract_hash_answer(text: str) -&gt; str: Â </span><span leaf><br></span><span leaf>Â  Â Â </span><span><span leaf>""</span></span><span><span leaf>"ä»GSM8Kæ ¼å¼ä¸­æå–ç­”æ¡ˆï¼ˆ###æ ‡è®°ä¹‹åï¼‰ã€‚"</span></span><span><span leaf>""</span></span><span leaf><br></span><span leaf>Â  Â Â </span><span><span leaf>if</span></span><span><span leaf>"####"</span></span><span leaf>Â notÂ </span><span><span leaf>in</span></span><span leaf>Â text: Â </span><span leaf><br></span><span leaf>Â  Â  Â  Â Â </span><span><span leaf>return</span></span><span><span leaf>""</span></span><span leaf><br></span><span leaf>Â  Â Â </span><span><span leaf>return</span></span><span leaf>Â text.split(</span><span><span leaf>"###"</span></span><span leaf>)[1].strip().replace(</span><span><span leaf>"."</span></span><span leaf>,Â </span><span><span leaf>""</span></span><span leaf>).replace(</span><span><span leaf>"$"</span></span><span leaf>,Â </span><span><span leaf>""</span></span><span leaf>)</span><span leaf><br></span></code></pre><h3 data-tool=mdniceç¼–è¾‘å™¨><span></span><span><span leaf>åŠ è½½å¹¶å‡†å¤‡GSM8Kæ•°æ®é›†</span></span><span></span></h3><pre data-tool=mdniceç¼–è¾‘å™¨><span data-cacheurl data-remoteid></span><code><span leaf>def get_gsm8k_questions(split=</span><span><span leaf>"train"</span></span><span leaf>, max_samples=100) -&gt; Dataset: Â </span><span leaf>Â  Â Â </span><span><span leaf>""</span></span><span><span leaf>" Â </span><span leaf><br></span><span leaf>Â  Â  åŠ è½½GSM8Kæ•°æ®é›†å¹¶æ ¼å¼åŒ–ä¸ºGRPOè®­ç»ƒæ‰€éœ€å½¢å¼ã€‚ Â </span><span leaf><br></span><span leaf>Â  Â  å‚æ•°ï¼š Â </span><span leaf><br></span><span leaf>Â  Â  Â  Â  split: ä½¿ç”¨çš„æ•°æ®é›†åˆ’åˆ†ï¼ˆtrain, testï¼‰ Â </span><span leaf><br></span><span leaf>Â  Â  Â  Â  max_samples: ä½¿ç”¨çš„æœ€å¤§æ ·æœ¬æ•°ï¼ˆç”¨äºå¿«é€Ÿå®éªŒï¼‰ Â </span><span leaf><br></span><span leaf>Â  Â  "</span></span><span><span leaf>""</span></span><span leaf>Â  Â  data = load_dataset(</span><span><span leaf>'openai/gsm8k'</span></span><span leaf>,Â </span><span><span leaf>'main'</span></span><span leaf>)[split] Â </span><span leaf>Â  Â Â </span><span><span leaf># é™åˆ¶æ•°æ®é›†å¤§å°ä»¥åŠ å¿«å®éªŒ Â </span></span><span leaf>Â  Â Â </span><span><span leaf>if</span></span><span leaf>Â max_samples and max_samples &lt; len(data): Â </span><span leaf>Â  Â  Â  Â  data = data.select(range(max_samples)) Â </span><span leaf>Â  Â Â </span><span><span leaf># æ ¼å¼åŒ–æ•°æ®ä¸ºæ‰€éœ€çš„æç¤ºç»“æ„ Â </span></span><span leaf>Â  Â  data = data.map(lambda x: { Â </span><span leaf>Â  Â  Â  Â Â </span><span><span leaf>'prompt'</span></span><span leaf>: [ Â </span><span leaf>Â  Â  Â  Â  Â  Â  {</span><span><span leaf>'role'</span></span><span leaf>:Â </span><span><span leaf>'system'</span></span><span leaf>,Â </span><span><span leaf>'content'</span></span><span leaf>: SYSTEM_PROMPT}, Â </span><span leaf>Â  Â  Â  Â  Â  Â  {</span><span><span leaf>'role'</span></span><span leaf>:Â </span><span><span leaf>'user'</span></span><span leaf>,Â </span><span><span leaf>'content'</span></span><span leaf>: x[</span><span><span leaf>'question'</span></span><span leaf>]} Â </span><span leaf>Â  Â  Â  Â  ], Â </span><span leaf>Â  Â  Â  Â Â </span><span><span leaf>'answer'</span></span><span leaf>: extract_hash_answer(x[</span><span><span leaf>'answer'</span></span><span leaf>]) Â </span><span leaf>Â  Â  }) Â </span><span leaf>Â  Â Â </span><span><span leaf>return</span></span><span leaf>Â data</span><span leaf><br></span></code></pre><h3 data-tool=mdniceç¼–è¾‘å™¨><span></span><span><span leaf>å¥–åŠ±å‡½æ•°</span></span><span></span></h3><pre data-tool=mdniceç¼–è¾‘å™¨><span data-cacheurl data-remoteid></span><code><span leaf>def correctness_reward_func(prompts, completions, answer, **kwargs): Â </span><span leaf><br></span><span leaf>Â  Â Â </span><span><span leaf>""</span></span><span><span leaf>" Â </span><span leaf><br></span><span leaf>Â  Â  æ£€æŸ¥æå–çš„ç­”æ¡ˆæ˜¯å¦ä¸çœŸå®ç­”æ¡ˆåŒ¹é…çš„å¥–åŠ±å‡½æ•°ã€‚ Â </span><span leaf><br></span><span leaf>Â  Â  æ­£ç¡®ç­”æ¡ˆè¿”å›2.0ï¼Œå¦åˆ™è¿”å›0.0ã€‚ Â </span><span leaf><br></span><span leaf>Â  Â  "</span></span><span><span leaf>""</span></span><span leaf>Â  Â  responses = [completion[0][</span><span><span leaf>'content'</span></span><span leaf>]Â </span><span><span leaf>for</span></span><span leaf>Â completionÂ </span><span><span leaf>in</span></span><span leaf>Â completions] Â </span><span leaf>Â  Â  q = prompts[0][-1][</span><span><span leaf>'content'</span></span><span leaf>] Â </span><span leaf>Â  Â  extracted_responses = [extract_xml_answer(r)Â </span><span><span leaf>for</span></span><span leaf>Â rÂ </span><span><span leaf>in</span></span><span leaf>Â responses] Â </span><span leaf>Â  Â Â </span><span><span leaf># æ‰“å°è°ƒè¯•ä¿¡æ¯ Â </span></span><span leaf>Â  Â Â </span><span><span leaf>if</span></span><span leaf>Â kwargs.get(</span><span><span leaf>'debug'</span></span><span leaf>, False) and len(responses) &gt; 0: Â </span><span leaf>Â  Â  Â  Â Â </span><span><span leaf>print</span></span><span leaf>(</span><span><span leaf>'-'</span></span><span leaf>*20) Â </span><span leaf>Â  Â  Â  Â Â </span><span><span leaf>print</span></span><span leaf>(f</span><span><span leaf>"é—®é¢˜ï¼š\n{q}"</span></span><span leaf>) Â </span><span leaf>Â  Â  Â  Â Â </span><span><span leaf>print</span></span><span leaf>(f</span><span><span leaf>"\nçœŸå®ç­”æ¡ˆï¼š\n{answer[0]}"</span></span><span leaf>) Â </span><span leaf>Â  Â  Â  Â Â </span><span><span leaf>print</span></span><span leaf>(f</span><span><span leaf>"\næ¨¡å‹å“åº”ï¼š\n{responses[0]}"</span></span><span leaf>) Â </span><span leaf>Â  Â  Â  Â Â </span><span><span leaf>print</span></span><span leaf>(f</span><span><span leaf>"\næå–çš„ç­”æ¡ˆï¼š\n{extracted_responses[0]}"</span></span><span leaf>) Â </span><span leaf>Â  Â Â </span><span><span leaf>return</span></span><span leaf>Â [2.0Â </span><span><span leaf>if</span></span><span leaf>Â r == aÂ </span><span><span leaf>else</span></span><span leaf>Â 0.0Â </span><span><span leaf>for</span></span><span leaf>Â r, aÂ </span><span><span leaf>in</span></span><span leaf>Â zip(extracted_responses, answer)] Â </span><span leaf>def int_reward_func(completions, **kwargs) -&gt; list[</span><span><span leaf>float</span></span><span leaf>]: Â </span><span leaf>Â  Â Â </span><span><span leaf>""</span></span><span><span leaf>" Â </span><span leaf><br></span><span leaf>Â  Â  æ£€æŸ¥æå–çš„ç­”æ¡ˆæ˜¯å¦ä¸ºæ•°å­—çš„å¥–åŠ±å‡½æ•°ã€‚ Â </span><span leaf><br></span><span leaf>Â  Â  æ•´æ•°ç­”æ¡ˆè¿”å›0.5ï¼Œå¦åˆ™è¿”å›0.0ã€‚ Â </span><span leaf><br></span><span leaf>Â  Â  "</span></span><span><span leaf>""</span></span><span leaf>Â  Â  responses = [completion[0][</span><span><span leaf>'content'</span></span><span leaf>]Â </span><span><span leaf>for</span></span><span leaf>Â completionÂ </span><span><span leaf>in</span></span><span leaf>Â completions] Â </span><span leaf>Â  Â  extracted_responses = [extract_xml_answer(r)Â </span><span><span leaf>for</span></span><span leaf>Â rÂ </span><span><span leaf>in</span></span><span leaf>Â responses] Â </span><span leaf>Â  Â Â </span><span><span leaf>return</span></span><span leaf>Â [0.5Â </span><span><span leaf>if</span></span><span leaf>Â r.isdigit()Â </span><span><span leaf>else</span></span><span leaf>Â 0.0Â </span><span><span leaf>for</span></span><span leaf>Â rÂ </span><span><span leaf>in</span></span><span leaf>Â extracted_responses] Â </span><span leaf>def strict_format_reward_func(completions, **kwargs) -&gt; list[</span><span><span leaf>float</span></span><span leaf>]: Â </span><span leaf>Â  Â Â </span><span><span leaf>""</span></span><span><span leaf>" Â </span><span leaf><br></span><span leaf>Â  Â  æ£€æŸ¥è¡¥å…¨å†…å®¹æ˜¯å¦å®Œå…¨ç¬¦åˆæ ¼å¼çš„å¥–åŠ±å‡½æ•°ã€‚ Â </span><span leaf><br></span><span leaf>Â  Â  åŒ¹é…æ ¼å¼è¿”å›0.5ï¼Œå¦åˆ™è¿”å›0.0ã€‚ Â </span><span leaf><br></span><span leaf>Â  Â  "</span></span><span><span leaf>""</span></span><span leaf>Â  Â  pattern = r</span><span><span leaf>"^\n&lt;reasoning&gt;.*?&lt;/reasoning&gt;\n\n&lt;answer&gt;.*?&lt;/answer&gt;\n$"</span></span><span leaf>Â  Â  responses = [completion[0][</span><span><span leaf>'content'</span></span><span leaf>]Â </span><span><span leaf>for</span></span><span leaf>Â completionÂ </span><span><span leaf>in</span></span><span leaf>Â completions] Â </span><span leaf>Â  Â  matches = [bool(re.search(pattern, r, flags=re.DOTALL))Â </span><span><span leaf>for</span></span><span leaf>Â rÂ </span><span><span leaf>in</span></span><span leaf>Â responses] Â </span><span leaf>Â  Â Â </span><span><span leaf>return</span></span><span leaf>Â [0.5Â </span><span><span leaf>if</span></span><span leaf>Â matchÂ </span><span><span leaf>else</span></span><span leaf>Â 0.0Â </span><span><span leaf>for</span></span><span leaf>Â matchÂ </span><span><span leaf>in</span></span><span leaf>Â matches] Â </span><span leaf>def soft_format_reward_func(completions, **kwargs) -&gt; list[</span><span><span leaf>float</span></span><span leaf>]: Â </span><span leaf>Â  Â Â </span><span><span leaf>""</span></span><span><span leaf>" Â </span><span leaf><br></span><span leaf>Â  Â  å®½æ¾çš„æ ¼å¼æ£€æŸ¥å¥–åŠ±å‡½æ•°ã€‚ Â </span><span leaf><br></span><span leaf>Â  Â  åŒ¹é…æ ¼å¼è¿”å›0.5ï¼Œå¦åˆ™è¿”å›0.0ã€‚ Â </span><span leaf><br></span><span leaf>Â  Â  "</span></span><span><span leaf>""</span></span><span leaf>Â  Â  pattern = r</span><span><span leaf>"&lt;reasoning&gt;.*?&lt;/reasoning&gt;.*?&lt;answer&gt;.*?&lt;/answer&gt;"</span></span><span leaf>Â  Â  responses = [completion[0][</span><span><span leaf>'content'</span></span><span leaf>]Â </span><span><span leaf>for</span></span><span leaf>Â completionÂ </span><span><span leaf>in</span></span><span leaf>Â completions] Â </span><span leaf>Â  Â  matches = [bool(re.search(pattern, r, flags=re.DOTALL))Â </span><span><span leaf>for</span></span><span leaf>Â rÂ </span><span><span leaf>in</span></span><span leaf>Â responses] Â </span><span leaf>Â  Â Â </span><span><span leaf>return</span></span><span leaf>Â [0.5Â </span><span><span leaf>if</span></span><span leaf>Â matchÂ </span><span><span leaf>else</span></span><span leaf>Â 0.0Â </span><span><span leaf>for</span></span><span leaf>Â matchÂ </span><span><span leaf>in</span></span><span leaf>Â matches] Â </span><span leaf>def count_xml(text) -&gt;Â </span><span><span leaf>float</span></span><span leaf>: Â </span><span leaf>Â  Â Â </span><span><span leaf>""</span></span><span><span leaf>" Â </span><span leaf><br></span><span leaf>Â  Â  ç»Ÿè®¡XMLæ ‡ç­¾å¹¶ä¸ºæ¯ä¸ªæ­£ç¡®æ”¾ç½®çš„æ ‡ç­¾æä¾›éƒ¨åˆ†å¥–åŠ±ã€‚ Â </span><span leaf><br></span><span leaf>Â  Â  "</span></span><span><span leaf>""</span></span><span leaf>Â  Â  count = 0.0 Â </span><span leaf>Â  Â Â </span><span><span leaf>if</span></span><span leaf>Â text.count(</span><span><span leaf>"&lt;reasoning&gt;"</span></span><span leaf>) == 1: Â </span><span leaf>Â  Â  Â  Â  count += 0.125 Â </span><span leaf>Â  Â Â </span><span><span leaf>if</span></span><span leaf>Â text.count(</span><span><span leaf>"&lt;/reasoning&gt;"</span></span><span leaf>) == 1: Â </span><span leaf>Â  Â  Â  Â  count += 0.125 Â </span><span leaf>Â  Â Â </span><span><span leaf>if</span></span><span leaf>Â text.count(</span><span><span leaf>"&lt;answer&gt;"</span></span><span leaf>) == 1: Â </span><span leaf>Â  Â  Â  Â  count += 0.125 Â </span><span leaf>Â  Â Â </span><span><span leaf>if</span></span><span leaf>Â text.count(</span><span><span leaf>"&lt;/answer&gt;"</span></span><span leaf>) == 1: Â </span><span leaf>Â  Â  Â  Â  count += 0.125 Â </span><span leaf>Â  Â Â </span><span><span leaf>return</span></span><span leaf>Â count Â </span><span leaf>def xmlcount_reward_func(completions, **kwargs) -&gt; list[</span><span><span leaf>float</span></span><span leaf>]: Â </span><span leaf>Â  Â Â </span><span><span leaf>""</span></span><span><span leaf>" Â </span><span leaf><br></span><span leaf>Â  Â  åŸºäºå“åº”ä¸­XMLæ ‡ç­¾è®¡æ•°çš„å¥–åŠ±å‡½æ•°ã€‚ Â </span><span leaf><br></span><span leaf>Â  Â  "</span></span><span><span leaf>""</span></span><span leaf>Â  Â  contents = [completion[0][</span><span><span leaf>"content"</span></span><span leaf>]Â </span><span><span leaf>for</span></span><span leaf>Â completionÂ </span><span><span leaf>in</span></span><span leaf>Â completions] Â </span><span leaf>Â  Â Â </span><span><span leaf>return</span></span><span leaf>Â [count_xml(c)Â </span><span><span leaf>for</span></span><span leaf>Â cÂ </span><span><span leaf>in</span></span><span leaf>Â contents]</span><span leaf><br></span></code></pre><h3 data-tool=mdniceç¼–è¾‘å™¨><span></span><span><span leaf>æ¨¡å‹è®¾ç½®</span></span><span></span></h3><pre data-tool=mdniceç¼–è¾‘å™¨><span data-cacheurl data-remoteid></span><code><span leaf>model_name =Â </span><span><span leaf>"Qwen/Qwen2.5-1.5B-Instruct"</span></span><span leaf>Â Â </span><span leaf><br></span><span><span leaf># è®¾ç½®è¾“å‡ºç›®å½•å’Œè¿è¡Œåç§° Â </span></span><span leaf><br></span><span leaf>output_dir =Â </span><span><span leaf>"outputs/Qwen-1.5B-GRPO"</span></span><span leaf>Â Â </span><span leaf><br></span><span leaf>run_name =Â </span><span><span leaf>"Qwen-1.5B-GRPO-gsm8k"</span></span><span leaf><br></span></code></pre><h3 data-tool=mdniceç¼–è¾‘å™¨><span></span><span><span leaf>é…ç½®GRPOè®­ç»ƒ</span></span><span></span></h3><pre data-tool=mdniceç¼–è¾‘å™¨><span data-cacheurl data-remoteid></span><code><span leaf>training_args = GRPOConfig( Â </span><span leaf><br></span><span leaf>Â  Â  output_dir=output_dir, Â </span><span leaf>Â  Â  run_name=run_name, Â </span><span leaf>Â  Â  learning_rate=5e-6, Â </span><span leaf>Â  Â  adam_beta1=0.9, Â </span><span leaf>Â  Â  adam_beta2=0.99, Â </span><span leaf>Â  Â  weight_decay=0.1, Â </span><span leaf>Â  Â  warmup_ratio=0.1, Â </span><span leaf>Â  Â  lr_scheduler_type=</span><span><span leaf>'cosine'</span></span><span leaf>, Â </span><span leaf>Â  Â  logging_steps=1, Â </span><span leaf>Â  Â  bf16=False, Â </span><span><span leaf># è®¾ç½®ä¸ºFalseï¼Œå› ä¸ºColabä¸æ”¯æŒ Â </span></span><span leaf>Â  Â  fp16=True, Â Â </span><span><span leaf># ä½¿ç”¨fp16ä»¥æé«˜å…¼å®¹æ€§ Â </span></span><span leaf>Â  Â  per_device_train_batch_size=4, Â </span><span><span leaf># å¢åŠ ä»¥å…¼å®¹GRPO Â </span></span><span leaf>Â  Â  gradient_accumulation_steps=2, Â </span><span leaf>Â  Â  num_generations=4, Â </span><span><span leaf># å¿…é¡»æ˜¯per_device_train_batch_sizeçš„é™¤æ•° Â </span></span><span leaf>Â  Â  max_prompt_length=256, Â </span><span leaf>Â  Â  max_completion_length=512, Â </span><span leaf>Â  Â  num_train_epochs=1, Â </span><span leaf>Â  Â  save_steps=50, Â </span><span leaf>Â  Â  max_grad_norm=0.1, Â </span><span leaf>Â  Â  report_to=</span><span><span leaf>"none"</span></span><span leaf>, Â </span><span leaf>Â  Â  log_on_each_node=False, Â </span><span leaf>)</span><span leaf><br></span></code></pre><h3 data-tool=mdniceç¼–è¾‘å™¨><span></span><span><span leaf>é…ç½®LoRAè¿›è¡Œå‚æ•°é«˜æ•ˆå¾®è°ƒ</span></span><span></span></h3><pre data-tool=mdniceç¼–è¾‘å™¨><span data-cacheurl data-remoteid></span><code><span leaf>peft_config = LoraConfig( Â </span><span leaf><br></span><span leaf>Â  Â  r=8, Â </span><span><span leaf># ä»16å‡å°‘ä»¥é€‚åº”Colabå†…å­˜ Â </span></span><span leaf><br></span><span leaf>Â  Â  lora_alpha=32, Â </span><span leaf><br></span><span leaf>Â  Â  target_modules=[</span><span><span leaf>"q_proj"</span></span><span leaf>,Â </span><span><span leaf>"k_proj"</span></span><span leaf>,Â </span><span><span leaf>"v_proj"</span></span><span leaf>,Â </span><span><span leaf>"o_proj"</span></span><span leaf>], Â </span><span><span leaf># ç®€åŒ–ç›®æ ‡æ¨¡å— Â </span></span><span leaf><br></span><span leaf>Â  Â  task_type=</span><span><span leaf>"CAUSAL_LM"</span></span><span leaf>, Â </span><span leaf><br></span><span leaf>Â  Â  lora_dropout=0.05, Â </span><span leaf><br></span><span leaf>)</span><span leaf><br></span></code></pre><h3 data-tool=mdniceç¼–è¾‘å™¨><span></span><span><span leaf>åŠ è½½å¹¶å‡†å¤‡æ¨¡å‹</span></span><span></span></h3><pre data-tool=mdniceç¼–è¾‘å™¨><span data-cacheurl data-remoteid></span><code><span><span leaf>print</span></span><span leaf>(f</span><span><span leaf>"åŠ è½½æ¨¡å‹ï¼š{model_name}"</span></span><span leaf>) Â </span><span leaf>model = AutoModelForCausalLM.from_pretrained( Â </span><span leaf>Â  Â  model_name, Â </span><span leaf>Â  Â  torch_dtype=torch.float16, Â </span><span><span leaf># ä½¿ç”¨float16è€Œébfloat16 Â </span></span><span leaf>Â  Â  device_map=</span><span><span leaf>"auto"</span></span><span leaf>, Â  Â  Â  Â  Â </span><span><span leaf># è®©æ¨¡å‹è‡ªåŠ¨é€‰æ‹©æœ€ä½³è®¾å¤‡é…ç½® Â </span></span><span leaf>Â  Â  low_cpu_mem_usage=True, Â  Â </span><span><span leaf># æé«˜å†…å­˜æ•ˆç‡ Â </span></span><span leaf>Â  Â  trust_remote_code=True Â  Â Â </span><span><span leaf># æ–°æ¨¡å‹æœ‰æ—¶éœ€è¦ Â </span></span><span leaf>) Â </span><span><span leaf># åŠ è½½åˆ†è¯å™¨ Â </span></span><span leaf>tokenizer = AutoTokenizer.from_pretrained(model_name) Â </span><span><span leaf>if</span></span><span leaf>Â tokenizer.pad_token is None: Â </span><span leaf>Â  Â  tokenizer.pad_token = tokenizer.eos_token Â </span><span><span leaf># åŠ è½½GSM8Kæ•°æ®é›†çš„å­é›† Â </span></span><span><span leaf>print</span></span><span leaf>(</span><span><span leaf>"åŠ è½½æ•°æ®é›†..."</span></span><span leaf>) Â </span><span leaf>dataset = get_gsm8k_questions(max_samples=20) Â </span><span><span leaf>print</span></span><span leaf>(f</span><span><span leaf>"æ•°æ®é›†åŠ è½½å®Œæˆï¼Œå…±{len(dataset)}ä¸ªç¤ºä¾‹"</span></span><span leaf>)</span><span leaf><br></span></code></pre><h3 data-tool=mdniceç¼–è¾‘å™¨><span></span><span><span leaf>åˆå§‹åŒ–GRPOè®­ç»ƒå™¨</span></span><span></span></h3><pre data-tool=mdniceç¼–è¾‘å™¨><span data-cacheurl data-remoteid></span><code><span><span leaf>print</span></span><span leaf>(</span><span><span leaf>"åˆå§‹åŒ–GRPOè®­ç»ƒå™¨..."</span></span><span leaf>) Â </span><span leaf><br></span><span leaf><br></span><span leaf>trainer = GRPOTrainer( Â </span><span leaf><br></span><span leaf>Â  Â  model=model, Â </span><span leaf><br></span><span leaf>Â  Â  processing_class=tokenizer, Â </span><span leaf><br></span><span leaf>Â  Â  reward_funcs=[ Â </span><span leaf><br></span><span leaf>Â  Â  Â  Â  xmlcount_reward_func, Â </span><span leaf><br></span><span leaf>Â  Â  Â  Â  soft_format_reward_func, Â </span><span leaf><br></span><span leaf>Â  Â  Â  Â  int_reward_func, Â </span><span leaf><br></span><span leaf>Â  Â  Â  Â  correctness_reward_func Â </span><span leaf><br></span><span leaf>Â  Â  ], Â </span><span leaf><br></span><span leaf>Â  Â  args=training_args, Â </span><span leaf><br></span><span leaf>Â  Â  train_dataset=dataset, Â </span><span leaf><br></span><span leaf>Â  Â  peft_config=peft_config Â </span><span><span leaf># å¯ç”¨LoRAè¿›è¡Œé«˜æ•ˆå¾®è°ƒ Â </span></span><span leaf><br></span><span leaf>)</span><span leaf><br></span></code></pre><h3 data-tool=mdniceç¼–è¾‘å™¨><span></span><span><span leaf>è¿è¡ŒGRPO</span></span><span></span></h3><pre data-tool=mdniceç¼–è¾‘å™¨><span data-cacheurl data-remoteid></span><code><span><span leaf># å¼€å§‹è®­ç»ƒ Â </span></span><span leaf><br></span><span><span leaf>print</span></span><span leaf>(</span><span><span leaf>"å¼€å§‹GRPOè®­ç»ƒ..."</span></span><span leaf>) Â </span><span leaf>trainer.train() Â </span><span><span leaf># ä¿å­˜æœ€ç»ˆæ¨¡å‹ Â </span></span><span><span leaf>print</span></span><span leaf>(</span><span><span leaf>"è®­ç»ƒå®Œæˆã€‚ä¿å­˜æ¨¡å‹..."</span></span><span leaf>) Â </span><span leaf>trainer.save_model() Â </span><span><span leaf># è®­ç»ƒåæµ‹è¯•æ¨¡å‹ Â </span></span><span><span leaf>print</span></span><span leaf>(</span><span><span leaf>"\n--- æµ‹è¯•è®­ç»ƒåçš„æ¨¡å‹ ---\n"</span></span><span leaf>) Â </span><span><span leaf># ç”Ÿæˆé¢„æµ‹çš„å‡½æ•° Â </span></span><span leaf>def generate_prediction(model, tokenizer, question, max_length=512): Â </span><span leaf>Â  Â  prompt = [ Â </span><span leaf>Â  Â  Â  Â  {</span><span><span leaf>'role'</span></span><span leaf>:Â </span><span><span leaf>'system'</span></span><span leaf>,Â </span><span><span leaf>'content'</span></span><span leaf>: SYSTEM_PROMPT}, Â </span><span leaf>Â  Â  Â  Â  {</span><span><span leaf>'role'</span></span><span leaf>:Â </span><span><span leaf>'user'</span></span><span leaf>,Â </span><span><span leaf>'content'</span></span><span leaf>: question} Â </span><span leaf>Â  Â  ] Â </span><span leaf>Â  Â Â </span><span><span leaf># æ ¼å¼åŒ–æç¤º Â </span></span><span leaf>Â  Â  messages = tokenizer.apply_chat_template(prompt, tokenize=False, add_generation_prompt=True) Â </span><span leaf>Â  Â Â </span><span><span leaf># åˆ†è¯è¾“å…¥ Â </span></span><span leaf>Â  Â  inputs = tokenizer(messages, return_tensors=</span><span><span leaf>"pt"</span></span><span leaf>).to(model.device) Â </span><span leaf>Â  Â Â </span><span><span leaf># ç”Ÿæˆå“åº” Â </span></span><span leaf>Â  Â  with torch.no_grad(): Â </span><span leaf>Â  Â  Â  Â  outputs = model.generate( Â </span><span leaf>Â  Â  Â  Â  Â  Â  **inputs, Â </span><span leaf>Â  Â  Â  Â  Â  Â  max_new_tokens=max_length, Â </span><span leaf>Â  Â  Â  Â  Â  Â  do_sample=False Â </span><span leaf>Â  Â  Â  Â  ) Â </span><span leaf>Â  Â Â </span><span><span leaf># è§£ç å“åº” Â </span></span><span leaf>Â  Â  response = tokenizer.decode(outputs[0][inputs.input_ids.shape[1]:], skip_special_tokens=True) Â </span><span leaf>Â  Â Â </span><span><span leaf>return</span></span><span leaf>Â response Â </span><span><span leaf># æµ‹è¯•æ•°æ®é›†ä¸­çš„å‡ ä¸ªç¤ºä¾‹ Â </span></span><span leaf>test_examples = dataset.select(range(3)) Â </span><span><span leaf>for</span></span><span leaf>Â i, exampleÂ </span><span><span leaf>in</span></span><span leaf>Â enumerate(test_examples): Â </span><span leaf>Â  Â  question = example[</span><span><span leaf>'prompt'</span></span><span leaf>][-1][</span><span><span leaf>'content'</span></span><span leaf>] Â </span><span leaf>Â  Â  ground_truth = example[</span><span><span leaf>'answer'</span></span><span leaf>] Â </span><span leaf>Â  Â Â </span><span><span leaf>print</span></span><span leaf>(f</span><span><span leaf>"\nç¤ºä¾‹ {i+1}:"</span></span><span leaf>) Â </span><span leaf>Â  Â Â </span><span><span leaf>print</span></span><span leaf>(f</span><span><span leaf>"é—®é¢˜ï¼š{question}"</span></span><span leaf>) Â </span><span leaf>Â  Â Â </span><span><span leaf>print</span></span><span leaf>(f</span><span><span leaf>"çœŸå®ç­”æ¡ˆï¼š{ground_truth}"</span></span><span leaf>) Â </span><span leaf>Â  Â Â </span><span><span leaf># ç”Ÿæˆé¢„æµ‹ Â </span></span><span leaf>Â  Â  response = generate_prediction(model, tokenizer, question) Â </span><span leaf>Â  Â Â </span><span><span leaf>print</span></span><span leaf>(f</span><span><span leaf>"æ¨¡å‹å“åº”ï¼š{response}"</span></span><span leaf>) Â </span><span leaf>Â  Â Â </span><span><span leaf># æå–ç­”æ¡ˆ Â </span></span><span leaf>Â  Â  extracted_answer = extract_xml_answer(response) Â </span><span leaf>Â  Â Â </span><span><span leaf>print</span></span><span leaf>(f</span><span><span leaf>"æå–çš„ç­”æ¡ˆï¼š{extracted_answer}"</span></span><span leaf>) Â </span><span leaf>Â  Â Â </span><span><span leaf>print</span></span><span leaf>(f</span><span><span leaf>"æ˜¯å¦æ­£ç¡®ï¼š{extracted_answer == ground_truth}"</span></span><span leaf>) Â </span><span leaf>Â  Â Â </span><span><span leaf>print</span></span><span leaf>(</span><span><span leaf>"-"</span></span><span leaf>Â * 50) Â </span><span><span leaf>print</span></span><span leaf>(</span><span><span leaf>"æå®šï¼"</span></span><span leaf>)</span><span leaf><br></span></code></pre><h2 data-tool=mdniceç¼–è¾‘å™¨><span data-cacheurl data-remoteid></span><span></span><span><span leaf>æ€»ç»“</span></span><span></span></h2><p data-tool=mdniceç¼–è¾‘å™¨><span leaf>è¿™ä¸€å®ç°å±•ç¤ºäº†GRPOçš„å·¥ä½œåŸç†ï¼Œä»¥åŠå¦‚ä½•åˆ©ç”¨å®ƒä¼˜åŒ–è¯­è¨€æ¨¡å‹ä»¥é€‚åº”ç‰¹å®šæ ¼å¼å’Œä»»åŠ¡ã€‚æ•°å­¦é—®é¢˜è§£å†³ä»»åŠ¡ä¸XMLæ ¼å¼çš„ç»“åˆï¼Œæ¸…æ™°åœ°ä½“ç°äº†è¯¥æŠ€æœ¯çš„èƒ½åŠ›ã€‚</span></p><p data-tool=mdniceç¼–è¾‘å™¨><span leaf>çœŸæ˜¯ä¸€æ¬¡æœ‰è¶£çš„å®è·µï¼</span></p></section><blockquote><p><span leaf>ä½œè€…ï¼šarjuné“¾æ¥ï¼šhttps://www.k-a.in/grpo-1B.html</span></p><p><span leaf>ç¼–è¾‘ï¼šAIç¿»è¯‘ã€ã€Œæ·±åº¦å­¦ä¹ è‡ªç„¶è¯­è¨€å¤„ç†ã€å…¬ä¼—å·æ¶¦è‰²</span></p></blockquote><section data-mpa-template=t mpa-from-tpl=t><section data-mid mpa-from-tpl=t><section data-mid mpa-from-tpl=t nodeleaf><img data-ratio=1.452 data-type=gif data-w=250 data-src="https://mmbiz.qpic.cn/mmbiz_gif/BfjzYen78aJ9jibPqC4UskObNfOib0yfKAaAc91ATL5qjKhtYfWFzia902H2WxfqrGISHpcSnSLK4jyb2qJd54w8w/640?wx_fmt=gif" src="https://mmbiz.qpic.cn/mmbiz_gif/BfjzYen78aJ9jibPqC4UskObNfOib0yfKAaAc91ATL5qjKhtYfWFzia902H2WxfqrGISHpcSnSLK4jyb2qJd54w8w/640?wx_fmt=gif"></section><section data-mid mpa-from-tpl=t><span leaf><br></span></section></section></section><h5><span><span leaf>ğŸ´â€â˜ ï¸å®è—çº§ğŸ´â€â˜ ï¸ åŸåˆ›å…¬ä¼—å·ã€</span><strong><span leaf>æ•°æ®STUDIO</span></strong><span leaf>ã€å†…å®¹è¶…çº§ç¡¬æ ¸ã€‚å…¬ä¼—å·ä»¥Pythonä¸ºæ ¸å¿ƒè¯­è¨€ï¼Œå‚ç›´äºæ•°æ®ç§‘å­¦é¢†åŸŸï¼ŒåŒ…æ‹¬</span></span><span><span leaf>å¯æˆ³</span></span><span><span leaf>ğŸ‘‰</span><strong><span leaf>Â </span></strong></span><strong><span leaf><a href="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=Mzk0OTI1OTQ2MQ==&amp;action=getalbum&amp;album_id=1974978822768771072&amp;scene=173&amp;from_msgid=2247519294&amp;from_itemidx=1&amp;count=3&amp;nolastread=1#wechat_redirect" textvalue target=_blank linktype=text data-linktype=2>Python</a></span></strong><span><strong><span><span leaf>ï½œ</span></span></strong></span><strong><span leaf><a href="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=Mzk0OTI1OTQ2MQ==&amp;action=getalbum&amp;album_id=2023684574089658370&amp;scene=173&amp;from_msgid=2247519619&amp;from_itemidx=2&amp;count=3&amp;nolastread=1#wechat_redirect" textvalue target=_blank linktype=text data-linktype=2>MySQL</a></span></strong><span><strong><span><span leaf>ï½œ</span></span></strong></span><strong><span leaf><a href="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=Mzk0OTI1OTQ2MQ==&amp;action=getalbum&amp;album_id=1974978820940054530&amp;scene=173&amp;from_msgid=2247518366&amp;from_itemidx=1&amp;count=3&amp;nolastread=1#wechat_redirect" textvalue target=_blank linktype=text data-linktype=2>æ•°æ®åˆ†æ</a></span></strong><span><strong><span><span leaf>ï½œ</span></span></strong></span><strong><span leaf><a href="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=Mzk0OTI1OTQ2MQ==&amp;action=getalbum&amp;album_id=1974991176839544834&amp;scene=173&amp;from_msgid=2247519244&amp;from_itemidx=1&amp;count=3&amp;nolastread=1#wechat_redirect" textvalue target=_blank linktype=text data-linktype=2>æ•°æ®å¯è§†åŒ–</a></span></strong><span><strong><span><span leaf>ï½œ</span></span></strong></span><strong><span leaf><a href="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=Mzk0OTI1OTQ2MQ==&amp;action=getalbum&amp;album_id=1963494160565354497&amp;scene=173&amp;from_msgid=2247512171&amp;from_itemidx=1&amp;count=3&amp;nolastread=1#wechat_redirect" textvalue target=_blank linktype=text data-linktype=2>æœºå™¨å­¦ä¹ ä¸æ•°æ®æŒ–æ˜</a></span></strong><span><strong><span><span leaf>ï½œ</span></span></strong></span><strong><span leaf><a href="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=Mzk0OTI1OTQ2MQ==&amp;action=getalbum&amp;album_id=2318258648965644288&amp;scene=173&amp;from_msgid=2247518366&amp;from_itemidx=1&amp;count=3&amp;nolastread=1#wechat_redirect" textvalue target=_blank linktype=text data-linktype=2>çˆ¬è™«</a></span></strong><span><span leaf>Â </span><span><span leaf>ç­‰ï¼Œä»å…¥é—¨åˆ°è¿›é˜¶ï¼</span></span></span></h5><p><span><span leaf>é•¿æŒ‰ğŸ‘‡å…³æ³¨- æ•°æ®STUDIO -è®¾ä¸ºæ˜Ÿæ ‡ï¼Œå¹²è´§é€Ÿé€’</span></span><span leaf><img data-ratio=0.3351851851851852 data-type=gif data-w=1080 data-src="https://mmbiz.qpic.cn/mmbiz_gif/gX9JE5tiaI78ZgGwzt8M0xnekvrATwDWP7y4cdlwy4WOrJSUIqRfncsEYsPYM9wkQ8Gpr57zCpzia124Gb2d7icTQ/640?wx_fmt=gif" src="https://mmbiz.qpic.cn/mmbiz_gif/gX9JE5tiaI78ZgGwzt8M0xnekvrATwDWP7y4cdlwy4WOrJSUIqRfncsEYsPYM9wkQ8Gpr57zCpzia124Gb2d7icTQ/640?wx_fmt=gif"><img data-ratio=0.08703703703703704 data-type=gif data-w=1080 data-src="https://mmbiz.qpic.cn/mmbiz_gif/gX9JE5tiaI7ickLkMzUmaxe4mdegUFLheymDmGI4OiaeeoY4K0ttDRGju4p6F7iaGfSb4H6EDCCCC9bo7KuLiblIdXQ/640?wx_fmt=gif" src="https://mmbiz.qpic.cn/mmbiz_gif/gX9JE5tiaI7ickLkMzUmaxe4mdegUFLheymDmGI4OiaeeoY4K0ttDRGju4p6F7iaGfSb4H6EDCCCC9bo7KuLiblIdXQ/640?wx_fmt=gif"></span></p><p><mp-style-type data-value=3></mp-style-type></p></div><hr><a href=https://mp.weixin.qq.com/s/EL7ZvtJS7WEeWI5P53qHDA ,target=_blank rel="noopener noreferrer">åŸæ–‡é“¾æ¥</a></div><footer class=post__footer><div class="post__tags tags clearfix"><svg class="tags__badge icon icon-tag" width="16" height="16" viewBox="0 0 32 32"><path d="M4 0h8s2 0 4 2l15 15s2 2 0 4L21 31s-2 2-4 0L2 16s-2-2-2-4V3s0-3 4-3m3 10a3 3 0 000-6 3 3 0 000 6"/></svg><ul class=tags__list><li class=tags__item><a class="tags__link btn" href=../../../tags/fetched/ rel=tag>fetched</a></li><li class=tags__item><a class="tags__link btn" href=../../../tags/%E6%95%B0%E6%8D%AEstudio/ rel=tag>æ•°æ®STUDIO</a></li></ul></div></footer></article></main><div class="authorbox clearfix"><div class=authorbox__header><span class=authorbox__name>About Bloger</span></div></div><nav class="pager flex"><div class="pager__item pager__item--prev"><a class=pager__link href=../../../posts/2025-04/%E7%A5%9E%E7%A7%98%E6%A8%A1%E5%9E%8B%E4%B8%8A%E7%BA%BF%E4%B8%89%E5%A4%A9%E5%B7%B2%E8%A2%AB%E7%8E%A9%E7%96%AF_%E7%BD%91%E5%8F%8B%E5%8F%91%E7%8E%B0%E5%A4%A7%E9%87%8Fopenai%E7%97%95%E8%BF%B9/ rel=prev><span class=pager__subtitle>Â«&#8201;Previous</span><p class=pager__title>ç¥ç§˜æ¨¡å‹ä¸Šçº¿ä¸‰å¤©å·²è¢«ç©ç–¯ ç½‘å‹å‘ç°å¤§é‡OpenAIç—•è¿¹</p></a></div><div class="pager__item pager__item--next"><a class=pager__link href=../../../posts/2025-04/_%E5%B1%B1%E8%A5%BF%E5%A4%A7%E5%90%8C%E8%AE%A2%E5%A9%9A%E5%BC%BA%E5%A5%B8%E6%A1%88_%E6%98%AF_%E5%A9%9A%E6%81%8B%E8%B5%84%E6%9C%AC%E4%B8%BB%E4%B9%89_%E5%B0%81%E5%BB%BA%E4%B8%BB%E4%B9%89_%E7%9A%84%E6%81%B6%E6%9E%9C/ rel=next><span class=pager__subtitle>Next&#8201;Â»</span><p class=pager__title>â€œå±±è¥¿å¤§åŒè®¢å©šå¼ºå¥¸æ¡ˆâ€æ˜¯â€œå©šæ‹èµ„æœ¬ä¸»ä¹‰+å°å»ºä¸»ä¹‰â€çš„æ¶æœ</p></a></div></nav><section class=comments><div id=disqus_thread></div><script>window.disqus_config=function(){},function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="//kkitown.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></section></div><aside class=sidebar><div class="widget-search widget"><form class=widget-search__form role=search method=get action=https://google.com/search><input class=widget-search__field type=search placeholder=Searchâ€¦ name=q aria-label=Searchâ€¦>
<input class=widget-search__submit type=submit value=Search>
<input type=hidden name=sitesearch value=https://ixxmu.github.io/></form></div><div class="widget-recent widget"><h4 class=widget__title>Recent Posts</h4><div class=widget__content><ul class=widget__list><li class=widget__item><a class=widget__link href=../../../posts/2025-07/%E9%9D%92%E5%B2%9B_%E6%9C%80%E7%BE%8E%E6%B5%B7%E8%BE%B9%E7%BE%8E%E6%9C%AF%E9%A6%86_%E9%97%AD%E9%A6%86_%E8%80%97%E8%B5%8419%E4%BA%BF_%E8%BF%90%E8%90%A5%E4%B8%8D%E5%88%B04%E5%B9%B4_%E7%BD%91%E5%8F%8B_%E5%8F%AF%E6%83%9C%E4%BA%86_%E4%BD%86%E7%BB%93%E5%B1%80%E4%B8%8D%E6%84%8F%E5%A4%96/>é’å²›â€œæœ€ç¾æµ·è¾¹ç¾æœ¯é¦†â€é—­é¦†ï¼è€—èµ„19äº¿ï¼Œè¿è¥ä¸åˆ°4å¹´ï¼ç½‘å‹ï¼šå¯æƒœäº†ï¼Œä½†ç»“å±€ä¸æ„å¤–</a></li><li class=widget__item><a class=widget__link href=../../../posts/2025-07/%E6%B8%B4%E6%9C%9B%E9%93%81%E9%A5%AD%E7%A2%97%E7%9A%84%E5%B9%B4%E8%BD%BB%E4%BA%BA_%E5%8E%BB%E5%9B%BD%E5%A4%96%E8%80%83%E5%85%AC%E4%B8%8A%E5%B2%B8/>æ¸´æœ›é“é¥­ç¢—çš„å¹´è½»äººï¼Œå»å›½å¤–è€ƒå…¬ä¸Šå²¸</a></li><li class=widget__item><a class=widget__link href=../../../posts/2025-07/%E6%8A%8A%E5%8F%B6%E7%BB%BF%E4%BD%93_%E5%81%B7_%E5%88%B0%E8%87%AA%E5%B7%B1%E4%BD%93%E5%86%85_%E8%BF%99%E4%BA%9B%E5%8A%A8%E7%89%A9%E6%99%92%E5%A4%AA%E9%98%B3%E5%B0%B1%E8%83%BD%E6%B4%BB/>æŠŠå¶ç»¿ä½“â€œå·â€åˆ°è‡ªå·±ä½“å†… è¿™äº›åŠ¨ç‰©æ™’å¤ªé˜³å°±èƒ½æ´»</a></li><li class=widget__item><a class=widget__link href=../../../posts/2025-07/14%E5%B9%B4%E5%89%8D%E7%9A%84%E4%B8%8A%E6%B5%B7%E6%BB%A9%E8%A1%80%E9%93%85%E8%AD%A6%E6%8A%A5___%E6%B7%B1%E5%BA%A6/>14å¹´å‰çš„ä¸Šæµ·æ»©è¡€é“…è­¦æŠ¥ | æ·±åº¦</a></li><li class=widget__item><a class=widget__link href=../../../posts/2025-07/%E7%94%98%E8%82%83%E8%A1%80%E9%93%85%E8%BF%99%E4%BA%8B%E5%8F%88%E8%A2%AB%E7%BD%91%E5%8F%8B%E4%BB%AC%E5%8F%91%E7%8E%B0%E4%BA%86%E7%AC%AC%E4%BA%8C%E7%BB%84%E7%96%91%E7%82%B9/>ç”˜è‚ƒè¡€é“…è¿™äº‹åˆè¢«ç½‘å‹ä»¬å‘ç°äº†ç¬¬äºŒç»„ç–‘ç‚¹</a></li></ul></div></div><div class="widget-categories widget"><h4 class=widget__title>Categories</h4><div class=widget__content><ul class=widget__list><li class=widget__item><a class=widget__link href=../../../categories/duty/>Duty</a></li><li class=widget__item><a class=widget__link href=../../../categories/duty2/>Duty2</a></li></ul></div></div><div class="widget-taglist widget"><h4 class=widget__title>Tags</h4><div class=widget__content><a class="widget-taglist__link widget__link btn" href=../../../tags/cnbeta/ title=Cnbeta>Cnbeta (142)</a>
<a class="widget-taglist__link widget__link btn" href=../../../tags/datawhale/ title=Datawhale>Datawhale (9)</a>
<a class="widget-taglist__link widget__link btn" href=../../../tags/drpei/ title=Drpei>Drpei (5)</a>
<a class="widget-taglist__link widget__link btn" href=../../../tags/fetched/ title=Fetched>Fetched (730)</a>
<a class="widget-taglist__link widget__link btn" href=../../../tags/githubdaily/ title=GitHubDaily>GitHubDaily (7)</a>
<a class="widget-taglist__link widget__link btn" href=../../../tags/%E4%B8%81%E9%A6%99%E5%9B%AD/ title=ä¸é¦™å›­>ä¸é¦™å›­ (30)</a>
<a class="widget-taglist__link widget__link btn" href=../../../tags/%E4%BA%BA%E7%89%A9/ title=äººç‰©>äººç‰© (15)</a>
<a class="widget-taglist__link widget__link btn" href=../../../tags/%E5%8D%97%E6%96%B9%E5%91%A8%E6%9C%AB/ title=å—æ–¹å‘¨æœ«>å—æ–¹å‘¨æœ« (11)</a>
<a class="widget-taglist__link widget__link btn" href=../../../tags/%E5%B0%8F%E4%BC%97%E8%BD%AF%E4%BB%B6/ title=å°ä¼—è½¯ä»¶>å°ä¼—è½¯ä»¶ (5)</a>
<a class="widget-taglist__link widget__link btn" href=../../../tags/%E5%B0%8F%E5%A4%A7%E5%A4%AB%E6%BC%AB%E7%94%BB/ title=å°å¤§å¤«æ¼«ç”»>å°å¤§å¤«æ¼«ç”» (5)</a>
<a class="widget-taglist__link widget__link btn" href=../../../tags/%E5%B0%91%E6%95%B0%E6%B4%BE/ title=å°‘æ•°æ´¾>å°‘æ•°æ´¾ (6)</a>
<a class="widget-taglist__link widget__link btn" href=../../../tags/%E5%BE%AA%E5%9B%A0%E7%BC%89%E8%8D%AF/ title=å¾ªå› ç¼‰è¯>å¾ªå› ç¼‰è¯ (7)</a>
<a class="widget-taglist__link widget__link btn" href=../../../tags/%E6%96%B0%E4%B9%A1%E5%9C%9F/ title=æ–°ä¹¡åœŸ>æ–°ä¹¡åœŸ (5)</a>
<a class="widget-taglist__link widget__link btn" href=../../../tags/%E6%98%9F%E7%90%83%E5%95%86%E4%B8%9A%E8%AF%84%E8%AE%BA/ title=æ˜Ÿçƒå•†ä¸šè¯„è®º>æ˜Ÿçƒå•†ä¸šè¯„è®º (6)</a>
<a class="widget-taglist__link widget__link btn" href=../../../tags/%E6%9C%88%E5%85%89%E5%8D%9A%E5%AE%A2/ title=æœˆå…‰åšå®¢>æœˆå…‰åšå®¢ (5)</a>
<a class="widget-taglist__link widget__link btn" href=../../../tags/%E6%9C%AA%E9%97%BBcode/ title=æœªé—»Code>æœªé—»Code (6)</a>
<a class="widget-taglist__link widget__link btn" href=../../../tags/%E6%A7%BD%E8%BE%B9%E5%BE%80%E4%BA%8B/ title=æ§½è¾¹å¾€äº‹>æ§½è¾¹å¾€äº‹ (7)</a>
<a class="widget-taglist__link widget__link btn" href=../../../tags/%E6%AF%8F%E6%97%A5%E4%BA%BA%E7%89%A9/ title=æ¯æ—¥äººç‰©>æ¯æ—¥äººç‰© (10)</a>
<a class="widget-taglist__link widget__link btn" href=../../../tags/%E6%B5%AA%E6%BD%AE%E5%B7%A5%E4%BD%9C%E5%AE%A4/ title=æµªæ½®å·¥ä½œå®¤>æµªæ½®å·¥ä½œå®¤ (5)</a>
<a class="widget-taglist__link widget__link btn" href=../../../tags/%E6%B5%AE%E4%B9%8B%E9%9D%99/ title=æµ®ä¹‹é™>æµ®ä¹‹é™ (6)</a>
<a class="widget-taglist__link widget__link btn" href=../../../tags/%E7%81%BC%E8%A7%81/ title=ç¼è§>ç¼è§ (7)</a>
<a class="widget-taglist__link widget__link btn" href=../../../tags/%E7%86%8A%E8%A8%80%E7%86%8A%E8%AF%AD/ title=ç†Šè¨€ç†Šè¯­>ç†Šè¨€ç†Šè¯­ (5)</a>
<a class="widget-taglist__link widget__link btn" href=../../../tags/%E7%94%9F%E4%BF%A1%E6%8A%80%E8%83%BD%E6%A0%91/ title=ç”Ÿä¿¡æŠ€èƒ½æ ‘>ç”Ÿä¿¡æŠ€èƒ½æ ‘ (10)</a>
<a class="widget-taglist__link widget__link btn" href=../../../tags/%E7%94%9F%E4%BF%A1%E8%8F%9C%E9%B8%9F%E5%9B%A2/ title=ç”Ÿä¿¡èœé¸Ÿå›¢>ç”Ÿä¿¡èœé¸Ÿå›¢ (6)</a>
<a class="widget-taglist__link widget__link btn" href=../../../tags/%E7%9F%A5%E8%AF%86%E5%88%86%E5%AD%90/ title=çŸ¥è¯†åˆ†å­>çŸ¥è¯†åˆ†å­ (14)</a>
<a class="widget-taglist__link widget__link btn" href=../../../tags/%E7%BD%91%E6%98%93%E6%95%B0%E8%AF%BB/ title=ç½‘æ˜“æ•°è¯»>ç½‘æ˜“æ•°è¯» (6)</a>
<a class="widget-taglist__link widget__link btn" href=../../../tags/%E8%B4%A2%E7%BB%8F%E4%B8%89%E5%88%86%E9%92%9F/ title=è´¢ç»ä¸‰åˆ†é’Ÿ>è´¢ç»ä¸‰åˆ†é’Ÿ (7)</a>
<a class="widget-taglist__link widget__link btn" href=../../../tags/%E8%B5%9B%E5%85%88%E7%94%9F/ title=èµ›å…ˆç”Ÿ>èµ›å…ˆç”Ÿ (5)</a>
<a class="widget-taglist__link widget__link btn" href=../../../tags/%E9%83%91%E5%B7%9E%E6%A5%BC%E5%B8%82/ title=éƒ‘å·æ¥¼å¸‚>éƒ‘å·æ¥¼å¸‚ (32)</a></div><a href=../../../tags/></a></div><div class="widget-social widget"><h4 class="widget-social__title widget__title">Social</h4><div class="widget-social__content widget__content"><div class="widget-social__item widget__item"><a class="widget-social__link widget__link btn" title=Facebook rel="noopener noreferrer" href=https://facebook.com/username target=_blank><svg class="widget-social__link-icon icon icon-facebook" width="24" height="24" viewBox="0 0 352 352"><path d="m0 32v288c0 17.5 14.5 32 32 32h288c17.5.0 32-14.5 32-32V32c0-17.5-14.5-32-32-32H32C14.5.0.0 14.5.0 32zm320 0v288h-83V212h41.5l6-48H237v-31c0-14 3.5-23.5 23.5-23.5h26V66c-4.4-.6-19.8-1.5-37.5-1.5-36.9.0-62 22.2-62 63.5v36h-42v48h42v108H32V32z"/></svg>
<span>Facebook</span></a></div><div class="widget-social__item widget__item"><a class="widget-social__link widget__link btn" title=Twitter rel="noopener noreferrer" href=https://twitter.com/username target=_blank><svg class="widget-social__link-icon icon icon-twitter" width="24" height="24" viewBox="0 0 384 312"><path d="m384 36.9c-14.1 6.3-29.3 10.5-45.2 12.4 16.3-9.7 28.8-25.2 34.6-43.6-15.2 9-32.1 15.6-50 19.1-14.4-15.2-34.9-24.8-57.5-24.8-43.5.0-78.8 35.3-78.8 78.8.0 6.2.7 12.2 2 17.9-65.5-3.3-123.5-34.6-162.4-82.3C20 26 16.1 39.6 16.1 54c0 27.3 13.9 51.4 35 65.6-12.9-.4-25.1-4-35.7-9.9v1c0 38.2 27.2 70 63.2 77.2-6.6 1.8-13.6 2.8-20.8 2.8-5.1.0-10-.5-14.8-1.4 10 31.3 39.1 54.1 73.6 54.7-27 21.1-60.9 33.7-97.8 33.7-6.4.0-12.6-.4-18.8-1.1C34.9 299 76.3 312 120.8 312c144.9.0 224.1-120 224.1-224.1.0-3.4-.1-6.8-.2-10.2 15.4-11.1 28.7-25 39.3-40.8z"/></svg>
<span>Twitter</span></a></div><div class="widget-social__item widget__item"><a class="widget-social__link widget__link btn" title=Instagram rel="noopener noreferrer" href=https://www.instagram.com/username target=_blank><svg class="widget-social__link-icon icon icon-instagram" width="24" height="24" viewBox="0 0 256 256"><circle cx="193" cy="59" r="15"/><path fill-rule="evenodd" d="M101 0h54c41 0 58.4 3.9 74.5 17C256.2 37.5 256 74.8 256 97.7v60c0 26.7.0 60.4-26.5 81.4-16 13.4-33.5 16.9-74.5 16.9h-54c-41 0-57.5-3.5-74.5-16.9C1 218.9.5 186.3.1 160.5L0 155V97.7c0-23-.2-60.2 26.5-80.7C45 2 60 0 101 0zm4.9 23h44.3c45.8.0 58.3 3.5 70.3 17.5 11.8 13.2 12 30.1 12.5 62.9V156c.2 20.8.3 45.8-12.5 59.5-12 14-24.5 17.5-70.3 17.5h-44.3c-45.9.0-57.3-3.5-70.4-17.5-12.2-13-12.3-36.5-12.4-56.7v-55.6c.4-32.6.7-49.6 12.4-62.7C48 26.5 60 23 105.9 23zm19.6 144.5a42 42 0 100-84 42 42 0 000 84zm0 22.5a64.5 64.5.0 100-129 64.5 64.5.0 000 129z"/></svg>
<span>Instagram</span></a></div></div></div></aside></div><footer class=footer><div class="container footer__container flex"><div class=footer__copyright>&copy; 2025 æ–‡å­—è½¨è¿¹.
<span class=footer__copyright-credits>Generated with <a href=https://gohugo.io/ rel="nofollow noopener" target=_blank>Hugo</a> and <a href=https://github.com/Vimux/Mainroad/ rel="nofollow noopener" target=_blank>Mainroad</a> theme.</span></div></div></footer></div><script async defer src=../../../js/menu.js></script><script src=../../../js/custom.js></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.6/MathJax.js?config=TeX-AMS-MML_HTMLorMML" async></script></body></html>