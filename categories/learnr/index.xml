<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>learnR on 生信文集</title><link>https://ixxmu.github.io/categories/learnr/</link><description>Recent content in learnR on 生信文集</description><generator>Hugo -- gohugo.io</generator><language>zh-cn</language><lastBuildDate>Thu, 07 Jan 2021 00:00:00 +0000</lastBuildDate><atom:link href="https://ixxmu.github.io/categories/learnr/index.xml" rel="self" type="application/rss+xml"/><item><title>给PCA画个圈圈儿</title><link>https://ixxmu.github.io/posts/learnr/how-to-draw-border-on-pca/</link><pubDate>Thu, 07 Jan 2021 00:00:00 +0000</pubDate><guid>https://ixxmu.github.io/posts/learnr/how-to-draw-border-on-pca/</guid><description>给PCA的结果加上轮廓范围
1.了解PCA 今天的主要目的就是给PCA的分组画图画个圈圈儿，对PCA的认识要有一定的基础，如果你不知道何为PCA以及对PCA的结果数据不太明白，强烈推荐补习一下知识。参见生信技能树文章 PCA-弱水三千，取哪一瓢饮 和 PCA-Statistics is the new sexy!!!</description></item><item><title>修改 R 包自带函数</title><link>https://ixxmu.github.io/posts/learnr/how-to-modify-function-from-r-package/</link><pubDate>Mon, 27 Jul 2020 00:00:00 +0000</pubDate><guid>https://ixxmu.github.io/posts/learnr/how-to-modify-function-from-r-package/</guid><description>记录下如何修改R包自带函数
修改R包自带函数，并将其回归到变量环境； 其实是从周运来的文章中看到的，就记录下来了，因为一定会有这个需求； 原文中更改了estimate中的函数，当然我也认为这个自带函数很烦人类，就是不知道如何操作它，这不来了
myfilterCommonGenes &amp;lt;- edit(estimate::filterCommonGenes) function (input.f, output.f, id = c(&amp;#34;GeneSymbol&amp;#34;, &amp;#34;EntrezID&amp;#34;)) { stopifnot((is.</description></item><item><title>FPKM RPKM TPM counts</title><link>https://ixxmu.github.io/posts/learnr/difference-of-fpkm-rpkm-tpm-counts/</link><pubDate>Fri, 05 Jun 2020 00:00:00 +0000</pubDate><guid>https://ixxmu.github.io/posts/learnr/difference-of-fpkm-rpkm-tpm-counts/</guid><description>记录标准化的概念以及一些步骤；理解加上收集
参考阅读： 跟着刘小泽一起回顾标准化方法 fpkm转化成tpm RNAseq数据，下载GEO中的FPKM文件后该怎么下游分析 标准化进行时
一般测序拿到的数据都是fpkm值，进行下游差异分析需要先将其转化为tpm再进行limma差异分析；转化为tpm之后仍需要判断是否对数据进行log标准化；
#一众转换函数 countToTpm &amp;lt;- function(counts, effLen) { rate &amp;lt;- log(counts) - log(effLen) denom &amp;lt;- log(sum(exp(rate))) exp(rate - denom + log(1e6)) } countToFpkm &amp;lt;- function(counts, effLen) { N &amp;lt;- sum(counts) exp( log(counts) + log(1e9) - log(effLen) - log(N) ) } fpkmToTpm &amp;lt;- function(fpkm) { exp(log(fpkm) - log(sum(fpkm)) + log(1e6)) } countToEffCounts &amp;lt;- function(counts, len, effLen) { counts * (len / effLen) } #计算TPM值，只需要用一下apply函数 tpms &amp;lt;- apply(expMatrix,2,fpkmToTpm) tpms[1:3,] #最后可以根据TPM的特征进行检查，看每列加和是否一致 colSums(tpms) 判断数据是否需要转换，果子的经验是10以内不需要 exprSet &amp;lt;- log2(exprSet+1) TPM值对总和应该是一致的，所以可以在此基础上对基因的表达量进行差异比较；虽然不是真的精确。</description></item><item><title>如何聚类并挑选类</title><link>https://ixxmu.github.io/posts/learnr/how-to-cluster-your-samples-through-different-ways/</link><pubDate>Fri, 05 Jun 2020 00:00:00 +0000</pubDate><guid>https://ixxmu.github.io/posts/learnr/how-to-cluster-your-samples-through-different-ways/</guid><description>用来展示聚类三张图吧 这篇文章 提到了聚类展示的三张图，这里定义展示一下，也是对聚类概念的加强和理解； 原文地址 如何找到合适的聚类？
不过我们可以基于不同聚类过程中使用的相似性算法和模块划分参数，选择一个最合适的数目。在K-means，PAM和层次聚类中选择合适的聚类数目，这些方法包括直接方法和统计检验方法。 1.直接方法 设置一些适合的划分标准，比如elbow和average silhouette法 2.统计检验方法 就是常用的假设检验方法，比如gap statistic</description></item><item><title>热图 troubleshooting</title><link>https://ixxmu.github.io/posts/learnr/heatmap-troubleshooting/</link><pubDate>Sat, 18 Apr 2020 00:00:00 +0000</pubDate><guid>https://ixxmu.github.io/posts/learnr/heatmap-troubleshooting/</guid><description>热图问题，会持续更新
热图算是一个比较多的需求，基础使用上手比较快，但是想要美化的满意，需要下一番功夫。 这里使用 pheatmap 来画图
library(pheatmap) library(AnnoProbe) ls(&amp;#34;package:AnnoProbe&amp;#34;) # 查看包自带数据和函数 ex&amp;lt;-GSE95166$genes_expr ex&amp;lt;-GSE95166$genes_expr pheatmap(ex) group_list=c(rep(&amp;#34;N&amp;#34;,4),rep(&amp;#34;P&amp;#34;,4)) ac&amp;lt;-data.</description></item></channel></rss>